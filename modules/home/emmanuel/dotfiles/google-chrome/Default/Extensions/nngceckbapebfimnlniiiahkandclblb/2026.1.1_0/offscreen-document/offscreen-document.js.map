{"version":3,"file":"offscreen-document/offscreen-document.js","mappings":"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AAIG,OAE7D,QAAQH,KACR,KAGoC,IAAIG,OAAO,qCAEF,IAAIA,OAAO,qBCkDhD,UADGD,EAEJ,QAFIA,EAGL,OAHKA,EAIF,UAJEA,EAKF,UAmBEE,EAII,iBCpGjB,IAAYC,ECAAC,GDAZ,SAAYD,GACV,YACA,oBACA,oBAEA,WAED,CAPD,CAAYA,IAAAA,EAAU,KCAtB,SAAYC,GACV,yBACA,iBACA,yCACA,2CACA,uCACA,qCACA,uCACA,mCACA,mCACA,qCACA,wCACA,oCACA,kCACA,8BACA,wCACA,sCACA,kBACA,sCACA,wCACA,4CACA,0CACA,kBACA,wBACA,gCACA,4BACA,4BACA,6CACD,CA5BD,CAAYA,IAAAA,EAAU,KAwCnBA,EAAWC,QACXD,EAAWE,IACXF,EAAWG,cACXH,EAAWI,gBACXJ,EAAWK,iBACXL,EAAWM,eACXN,EAAWO,cACXP,EAAWQ,iBACXR,EAAWS,gBACXT,EAAWU,cACXV,EAAWW,eACXX,EAAWY,aACXZ,EAAWa,YACXb,EAAWc,UACXd,EAAWe,cACXf,EAAWgB,eACXhB,EAAWiB,kBACXjB,EAAWkB,eACXlB,EAAWmB,eACXnB,EAAWoB,aACXpB,EAAWqB,aACXrB,EAAWsB,IACXtB,EAAWuB,WACXvB,EAAWwB,SACXxB,EAAWyB,SACXzB,EAAW0B,IACX1B,EAAW2B,OCjEd,IAAYC,ECAAC,ECKAC,ECNAC,ECAAC,ECAAC,GLCZ,SAAYL,GACV,mBACA,+CACA,4BACD,CAJD,CAAYA,IAAAA,EAAe,KCA3B,SAAYC,GACV,uCACA,sDACA,4CACA,8CACA,gDACA,8CACA,oDACA,8DACA,8DACA,0EACA,sEACA,0EAEA,0CACA,0CACA,0CACA,8DACA,8DACA,wCACA,gEACA,oDACA,oFACA,0FACA,oFACA,oEACA,0EACA,oEACA,4DACA,kDACA,4CACA,wFACA,oFAEA,kDACA,kDACA,kDAEA,wCACA,wCACA,wCAEA,8DACA,kEACA,8DACA,8DACA,0EACA,sEACA,wFACA,4FACA,oFACA,wEACA,0EACA,8DACA,gEACA,sFACA,sFACA,8DACA,wDAEA,sDACA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","sources":["webpack:///../../libs/logging/src/log-level.ts","webpack:///../../libs/logging/src/console-log.service.ts","webpack:///../../node_modules/tslib/tslib.es6.mjs","webpack:///../../../../src/internal/util/isFunction.ts","webpack:///../../../../src/internal/util/UnsubscriptionError.ts","webpack:///../../../../src/internal/util/createErrorClass.ts","webpack:///../../../../src/internal/util/arrRemove.ts","webpack:///../../../src/internal/Subscription.ts","webpack:///../../../src/internal/config.ts","webpack:///../../../../src/internal/scheduler/timeoutProvider.ts","webpack:///../../../../src/internal/util/noop.ts","webpack:///../../../src/internal/NotificationFactories.ts","webpack:///../../../../src/internal/util/errorContext.ts","webpack:///../../../src/internal/Subscriber.ts","webpack:///../../../../src/internal/util/reportUnhandledError.ts","webpack:///../../../../src/internal/symbol/observable.ts","webpack:///../../../../src/internal/util/identity.ts","webpack:///../../../../src/internal/util/pipe.ts","webpack:///../../../src/internal/Observable.ts","webpack:///../../libs/common/src/autofill/constants/match-patterns.ts","webpack:///../../libs/common/src/autofill/constants/index.ts","webpack:///../../libs/client-type/src/index.ts","webpack:///../../libs/common/src/enums/device-type.enum.ts","webpack:///../../libs/common/src/enums/event-system-user.enum.ts","webpack:///../../libs/common/src/enums/event-type.enum.ts","webpack:///../../libs/common/src/enums/http-status-code.enum.ts","webpack:///../../libs/common/src/enums/integration-type.enum.ts","webpack:///../../libs/common/src/enums/native-messaging-version.enum.ts","webpack:///../../libs/common/src/enums/notification-type.enum.ts","webpack:///../../libs/common/src/enums/push-notification-logout-reason.enum.ts","webpack:///./src/browser/safariApp.ts","webpack:///./src/platform/services/browser-clipboard.service.ts","webpack:///./src/platform/services/platform-utils/browser-platform-utils.service.ts","webpack:///./src/platform/browser/browser-api.register-content-scripts-polyfill.ts","webpack:///./src/platform/browser/browser-api.ts","webpack:///../../libs/platform/src/services/browser-service.ts","webpack:///./src/platform/offscreen-document/offscreen-document.ts"],"sourcesContent":["// FIXME: update to use a const object instead of a typescript enum\n// eslint-disable-next-line @bitwarden/platform/no-enums\nexport enum LogLevel {\n  Debug,\n  Info,\n  Warning,\n  Error,\n}\n","import { LogLevel } from \"./log-level\";\nimport { LogService } from \"./log.service\";\n\nexport class ConsoleLogService implements LogService {\n  protected timersMap: Map<string, [number, number]> = new Map();\n\n  constructor(\n    protected isDev: boolean,\n    protected filter: ((level: LogLevel) => boolean) | null = null,\n  ) {}\n\n  debug(message?: any, ...optionalParams: any[]) {\n    if (!this.isDev) {\n      return;\n    }\n    this.write(LogLevel.Debug, message, ...optionalParams);\n  }\n\n  info(message?: any, ...optionalParams: any[]) {\n    this.write(LogLevel.Info, message, ...optionalParams);\n  }\n\n  warning(message?: any, ...optionalParams: any[]) {\n    this.write(LogLevel.Warning, message, ...optionalParams);\n  }\n\n  error(message?: any, ...optionalParams: any[]) {\n    this.write(LogLevel.Error, message, ...optionalParams);\n  }\n\n  write(level: LogLevel, message?: any, ...optionalParams: any[]) {\n    if (this.filter != null && this.filter(level)) {\n      return;\n    }\n\n    switch (level) {\n      case LogLevel.Debug:\n        // eslint-disable-next-line\n        console.log(message, ...optionalParams);\n        break;\n      case LogLevel.Info:\n        // eslint-disable-next-line\n        console.log(message, ...optionalParams);\n        break;\n      case LogLevel.Warning:\n        // eslint-disable-next-line\n        console.warn(message, ...optionalParams);\n        break;\n      case LogLevel.Error:\n        // eslint-disable-next-line\n        console.error(message, ...optionalParams);\n        break;\n      default:\n        break;\n    }\n  }\n\n  measure(\n    start: DOMHighResTimeStamp,\n    trackGroup: string,\n    track: string,\n    name?: string,\n    properties?: [string, any][],\n  ): PerformanceMeasure {\n    const measureName = `[${track}]: ${name}`;\n\n    const measure = performance.measure(measureName, {\n      start: start,\n      detail: {\n        devtools: {\n          dataType: \"track-entry\",\n          track,\n          trackGroup,\n          properties,\n        },\n      },\n    });\n\n    this.info(`${measureName} took ${measure.duration}`, properties);\n    return measure;\n  }\n\n  mark(name: string): PerformanceMark {\n    const mark = performance.mark(name, {\n      detail: {\n        devtools: {\n          dataType: \"marker\",\n        },\n      },\n    });\n\n    this.info(mark.name, new Date().toISOString());\n\n    return mark;\n  }\n}\n","/******************************************************************************\nCopyright (c) Microsoft Corporation.\n\nPermission to use, copy, modify, and/or distribute this software for any\npurpose with or without fee is hereby granted.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\nPERFORMANCE OF THIS SOFTWARE.\n***************************************************************************** */\n/* global Reflect, Promise, SuppressedError, Symbol, Iterator */\n\nvar extendStatics = function(d, b) {\n  extendStatics = Object.setPrototypeOf ||\n      ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n      function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n  return extendStatics(d, b);\n};\n\nexport function __extends(d, b) {\n  if (typeof b !== \"function\" && b !== null)\n      throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n  extendStatics(d, b);\n  function __() { this.constructor = d; }\n  d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n}\n\nexport var __assign = function() {\n  __assign = Object.assign || function __assign(t) {\n      for (var s, i = 1, n = arguments.length; i < n; i++) {\n          s = arguments[i];\n          for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n      return t;\n  }\n  return __assign.apply(this, arguments);\n}\n\nexport function __rest(s, e) {\n  var t = {};\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n      t[p] = s[p];\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n      for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n          if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n              t[p[i]] = s[p[i]];\n      }\n  return t;\n}\n\nexport function __decorate(decorators, target, key, desc) {\n  var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n  else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n}\n\nexport function __param(paramIndex, decorator) {\n  return function (target, key) { decorator(target, key, paramIndex); }\n}\n\nexport function __esDecorate(ctor, descriptorIn, decorators, contextIn, initializers, extraInitializers) {\n  function accept(f) { if (f !== void 0 && typeof f !== \"function\") throw new TypeError(\"Function expected\"); return f; }\n  var kind = contextIn.kind, key = kind === \"getter\" ? \"get\" : kind === \"setter\" ? \"set\" : \"value\";\n  var target = !descriptorIn && ctor ? contextIn[\"static\"] ? ctor : ctor.prototype : null;\n  var descriptor = descriptorIn || (target ? Object.getOwnPropertyDescriptor(target, contextIn.name) : {});\n  var _, done = false;\n  for (var i = decorators.length - 1; i >= 0; i--) {\n      var context = {};\n      for (var p in contextIn) context[p] = p === \"access\" ? {} : contextIn[p];\n      for (var p in contextIn.access) context.access[p] = contextIn.access[p];\n      context.addInitializer = function (f) { if (done) throw new TypeError(\"Cannot add initializers after decoration has completed\"); extraInitializers.push(accept(f || null)); };\n      var result = (0, decorators[i])(kind === \"accessor\" ? { get: descriptor.get, set: descriptor.set } : descriptor[key], context);\n      if (kind === \"accessor\") {\n          if (result === void 0) continue;\n          if (result === null || typeof result !== \"object\") throw new TypeError(\"Object expected\");\n          if (_ = accept(result.get)) descriptor.get = _;\n          if (_ = accept(result.set)) descriptor.set = _;\n          if (_ = accept(result.init)) initializers.unshift(_);\n      }\n      else if (_ = accept(result)) {\n          if (kind === \"field\") initializers.unshift(_);\n          else descriptor[key] = _;\n      }\n  }\n  if (target) Object.defineProperty(target, contextIn.name, descriptor);\n  done = true;\n};\n\nexport function __runInitializers(thisArg, initializers, value) {\n  var useValue = arguments.length > 2;\n  for (var i = 0; i < initializers.length; i++) {\n      value = useValue ? initializers[i].call(thisArg, value) : initializers[i].call(thisArg);\n  }\n  return useValue ? value : void 0;\n};\n\nexport function __propKey(x) {\n  return typeof x === \"symbol\" ? x : \"\".concat(x);\n};\n\nexport function __setFunctionName(f, name, prefix) {\n  if (typeof name === \"symbol\") name = name.description ? \"[\".concat(name.description, \"]\") : \"\";\n  return Object.defineProperty(f, \"name\", { configurable: true, value: prefix ? \"\".concat(prefix, \" \", name) : name });\n};\n\nexport function __metadata(metadataKey, metadataValue) {\n  if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\n}\n\nexport function __awaiter(thisArg, _arguments, P, generator) {\n  function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n  return new (P || (P = Promise))(function (resolve, reject) {\n      function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n      function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n      function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n      step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n}\n\nexport function __generator(thisArg, body) {\n  var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g = Object.create((typeof Iterator === \"function\" ? Iterator : Object).prototype);\n  return g.next = verb(0), g[\"throw\"] = verb(1), g[\"return\"] = verb(2), typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n  function verb(n) { return function (v) { return step([n, v]); }; }\n  function step(op) {\n      if (f) throw new TypeError(\"Generator is already executing.\");\n      while (g && (g = 0, op[0] && (_ = 0)), _) try {\n          if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n          if (y = 0, t) op = [op[0] & 2, t.value];\n          switch (op[0]) {\n              case 0: case 1: t = op; break;\n              case 4: _.label++; return { value: op[1], done: false };\n              case 5: _.label++; y = op[1]; op = [0]; continue;\n              case 7: op = _.ops.pop(); _.trys.pop(); continue;\n              default:\n                  if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                  if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                  if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                  if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                  if (t[2]) _.ops.pop();\n                  _.trys.pop(); continue;\n          }\n          op = body.call(thisArg, _);\n      } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n      if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n  }\n}\n\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  var desc = Object.getOwnPropertyDescriptor(m, k);\n  if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n  }\n  Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\n\nexport function __exportStar(m, o) {\n  for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\n}\n\nexport function __values(o) {\n  var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\n  if (m) return m.call(o);\n  if (o && typeof o.length === \"number\") return {\n      next: function () {\n          if (o && i >= o.length) o = void 0;\n          return { value: o && o[i++], done: !o };\n      }\n  };\n  throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\n}\n\nexport function __read(o, n) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n  if (!m) return o;\n  var i = m.call(o), r, ar = [], e;\n  try {\n      while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n  }\n  catch (error) { e = { error: error }; }\n  finally {\n      try {\n          if (r && !r.done && (m = i[\"return\"])) m.call(i);\n      }\n      finally { if (e) throw e.error; }\n  }\n  return ar;\n}\n\n/** @deprecated */\nexport function __spread() {\n  for (var ar = [], i = 0; i < arguments.length; i++)\n      ar = ar.concat(__read(arguments[i]));\n  return ar;\n}\n\n/** @deprecated */\nexport function __spreadArrays() {\n  for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n  for (var r = Array(s), k = 0, i = 0; i < il; i++)\n      for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\n          r[k] = a[j];\n  return r;\n}\n\nexport function __spreadArray(to, from, pack) {\n  if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n      if (ar || !(i in from)) {\n          if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n          ar[i] = from[i];\n      }\n  }\n  return to.concat(ar || Array.prototype.slice.call(from));\n}\n\nexport function __await(v) {\n  return this instanceof __await ? (this.v = v, this) : new __await(v);\n}\n\nexport function __asyncGenerator(thisArg, _arguments, generator) {\n  if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\n  var g = generator.apply(thisArg, _arguments || []), i, q = [];\n  return i = Object.create((typeof AsyncIterator === \"function\" ? AsyncIterator : Object).prototype), verb(\"next\"), verb(\"throw\"), verb(\"return\", awaitReturn), i[Symbol.asyncIterator] = function () { return this; }, i;\n  function awaitReturn(f) { return function (v) { return Promise.resolve(v).then(f, reject); }; }\n  function verb(n, f) { if (g[n]) { i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; if (f) i[n] = f(i[n]); } }\n  function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\n  function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\n  function fulfill(value) { resume(\"next\", value); }\n  function reject(value) { resume(\"throw\", value); }\n  function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\n}\n\nexport function __asyncDelegator(o) {\n  var i, p;\n  return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\n  function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: false } : f ? f(v) : v; } : f; }\n}\n\nexport function __asyncValues(o) {\n  if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\n  var m = o[Symbol.asyncIterator], i;\n  return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\n  function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\n  function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\n}\n\nexport function __makeTemplateObject(cooked, raw) {\n  if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\n  return cooked;\n};\n\nvar __setModuleDefault = Object.create ? (function(o, v) {\n  Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n  o[\"default\"] = v;\n};\n\nvar ownKeys = function(o) {\n  ownKeys = Object.getOwnPropertyNames || function (o) {\n    var ar = [];\n    for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;\n    return ar;\n  };\n  return ownKeys(o);\n};\n\nexport function __importStar(mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== \"default\") __createBinding(result, mod, k[i]);\n  __setModuleDefault(result, mod);\n  return result;\n}\n\nexport function __importDefault(mod) {\n  return (mod && mod.__esModule) ? mod : { default: mod };\n}\n\nexport function __classPrivateFieldGet(receiver, state, kind, f) {\n  if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\n  if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\n  return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\n}\n\nexport function __classPrivateFieldSet(receiver, state, value, kind, f) {\n  if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\n  if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\n  if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\n  return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\n}\n\nexport function __classPrivateFieldIn(state, receiver) {\n  if (receiver === null || (typeof receiver !== \"object\" && typeof receiver !== \"function\")) throw new TypeError(\"Cannot use 'in' operator on non-object\");\n  return typeof state === \"function\" ? receiver === state : state.has(receiver);\n}\n\nexport function __addDisposableResource(env, value, async) {\n  if (value !== null && value !== void 0) {\n    if (typeof value !== \"object\" && typeof value !== \"function\") throw new TypeError(\"Object expected.\");\n    var dispose, inner;\n    if (async) {\n      if (!Symbol.asyncDispose) throw new TypeError(\"Symbol.asyncDispose is not defined.\");\n      dispose = value[Symbol.asyncDispose];\n    }\n    if (dispose === void 0) {\n      if (!Symbol.dispose) throw new TypeError(\"Symbol.dispose is not defined.\");\n      dispose = value[Symbol.dispose];\n      if (async) inner = dispose;\n    }\n    if (typeof dispose !== \"function\") throw new TypeError(\"Object not disposable.\");\n    if (inner) dispose = function() { try { inner.call(this); } catch (e) { return Promise.reject(e); } };\n    env.stack.push({ value: value, dispose: dispose, async: async });\n  }\n  else if (async) {\n    env.stack.push({ async: true });\n  }\n  return value;\n}\n\nvar _SuppressedError = typeof SuppressedError === \"function\" ? SuppressedError : function (error, suppressed, message) {\n  var e = new Error(message);\n  return e.name = \"SuppressedError\", e.error = error, e.suppressed = suppressed, e;\n};\n\nexport function __disposeResources(env) {\n  function fail(e) {\n    env.error = env.hasError ? new _SuppressedError(e, env.error, \"An error was suppressed during disposal.\") : e;\n    env.hasError = true;\n  }\n  var r, s = 0;\n  function next() {\n    while (r = env.stack.pop()) {\n      try {\n        if (!r.async && s === 1) return s = 0, env.stack.push(r), Promise.resolve().then(next);\n        if (r.dispose) {\n          var result = r.dispose.call(r.value);\n          if (r.async) return s |= 2, Promise.resolve(result).then(next, function(e) { fail(e); return next(); });\n        }\n        else s |= 1;\n      }\n      catch (e) {\n        fail(e);\n      }\n    }\n    if (s === 1) return env.hasError ? Promise.reject(env.error) : Promise.resolve();\n    if (env.hasError) throw env.error;\n  }\n  return next();\n}\n\nexport function __rewriteRelativeImportExtension(path, preserveJsx) {\n  if (typeof path === \"string\" && /^\\.\\.?\\//.test(path)) {\n      return path.replace(/\\.(tsx)$|((?:\\.d)?)((?:\\.[^./]+?)?)\\.([cm]?)ts$/i, function (m, tsx, d, ext, cm) {\n          return tsx ? preserveJsx ? \".jsx\" : \".js\" : d && (!ext || !cm) ? m : (d + ext + \".\" + cm.toLowerCase() + \"js\");\n      });\n  }\n  return path;\n}\n\nexport default {\n  __extends,\n  __assign,\n  __rest,\n  __decorate,\n  __param,\n  __esDecorate,\n  __runInitializers,\n  __propKey,\n  __setFunctionName,\n  __metadata,\n  __awaiter,\n  __generator,\n  __createBinding,\n  __exportStar,\n  __values,\n  __read,\n  __spread,\n  __spreadArrays,\n  __spreadArray,\n  __await,\n  __asyncGenerator,\n  __asyncDelegator,\n  __asyncValues,\n  __makeTemplateObject,\n  __importStar,\n  __importDefault,\n  __classPrivateFieldGet,\n  __classPrivateFieldSet,\n  __classPrivateFieldIn,\n  __addDisposableResource,\n  __disposeResources,\n  __rewriteRelativeImportExtension,\n};\n",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"export const CardExpiryDateDelimiters: string[] = [\"/\", \"-\", \".\", \" \"];\n\n// `CardExpiryDateDelimiters` is not intended solely for regex consumption,\n// so we need to format it here\nexport const ExpiryDateDelimitersPattern =\n  \"\\\\\" +\n  CardExpiryDateDelimiters.join(\"\\\\\")\n    // replace space character with the regex whitespace character class\n    .replace(\" \", \"s\");\n\nexport const MonthPattern = \"(([1]{1}[0-2]{1})|(0?[1-9]{1}))\";\n\n// Because we're dealing with expiry dates, we assume the year will be in current or next century (as of 2024)\nexport const ExpiryFullYearPattern = \"2[0-1]{1}\\\\d{2}\";\n\nexport const DelimiterPatternExpression = new RegExp(`[${ExpiryDateDelimitersPattern}]`, \"g\");\n\nexport const IrrelevantExpiryCharactersPatternExpression = new RegExp(\n  // \"nor digits\" to ensure numbers are removed from guidance pattern, which aren't covered by ^\\w\n  `[^\\\\d${ExpiryDateDelimitersPattern}]`,\n  \"g\",\n);\n\nexport const MonthPatternExpression = new RegExp(`^${MonthPattern}$`);\n\nexport const ExpiryFullYearPatternExpression = new RegExp(`^${ExpiryFullYearPattern}$`);\n","export const TYPE_CHECK = {\n  FUNCTION: \"function\",\n  NUMBER: \"number\",\n  STRING: \"string\",\n} as const;\n\nexport const EVENTS = {\n  CHANGE: \"change\",\n  INPUT: \"input\",\n  KEYDOWN: \"keydown\",\n  KEYPRESS: \"keypress\",\n  KEYUP: \"keyup\",\n  BLUR: \"blur\",\n  CLICK: \"click\",\n  FOCUS: \"focus\",\n  FOCUSIN: \"focusin\",\n  FOCUSOUT: \"focusout\",\n  SCROLL: \"scroll\",\n  RESIZE: \"resize\",\n  DOMCONTENTLOADED: \"DOMContentLoaded\",\n  LOAD: \"load\",\n  MESSAGE: \"message\",\n  VISIBILITYCHANGE: \"visibilitychange\",\n  MOUSEENTER: \"mouseenter\",\n  MOUSELEAVE: \"mouseleave\",\n  MOUSEUP: \"mouseup\",\n  MOUSEOUT: \"mouseout\",\n  SUBMIT: \"submit\",\n} as const;\n\nexport const ClearClipboardDelay = {\n  Never: null as null,\n  TenSeconds: 10,\n  TwentySeconds: 20,\n  ThirtySeconds: 30,\n  OneMinute: 60,\n  TwoMinutes: 120,\n  FiveMinutes: 300,\n} as const;\n\n/* Ids for context menu items and messaging events */\nexport const AUTOFILL_CARD_ID = \"autofill-card\";\nexport const AUTOFILL_ID = \"autofill\";\nexport const SHOW_AUTOFILL_BUTTON = \"show-autofill-button\";\nexport const AUTOFILL_IDENTITY_ID = \"autofill-identity\";\nexport const COPY_IDENTIFIER_ID = \"copy-identifier\";\nexport const COPY_PASSWORD_ID = \"copy-password\";\nexport const COPY_USERNAME_ID = \"copy-username\";\nexport const COPY_VERIFICATION_CODE_ID = \"copy-totp\";\nexport const CREATE_CARD_ID = \"create-card\";\nexport const CREATE_IDENTITY_ID = \"create-identity\";\nexport const CREATE_LOGIN_ID = \"create-login\";\nexport const GENERATE_PASSWORD_ID = \"generate-password\";\nexport const NOOP_COMMAND_SUFFIX = \"noop\";\nexport const ROOT_ID = \"root\";\nexport const SEPARATOR_ID = \"separator\";\nexport const UPDATE_PASSWORD = \"update-password\";\n\nexport const NOTIFICATION_BAR_LIFESPAN_MS = 150000; // 150 seconds\n\nexport const AUTOFILL_OVERLAY_HANDLE_REPOSITION = \"autofill-overlay-handle-reposition-event\";\n\nexport const AUTOFILL_OVERLAY_HANDLE_SCROLL = \"autofill-overlay-handle-scroll-event\";\n\nexport const UPDATE_PASSKEYS_HEADINGS_ON_SCROLL = \"update-passkeys-headings-on-scroll\";\n\nexport const AUTOFILL_TRIGGER_FORM_FIELD_SUBMIT = \"autofill-trigger-form-field-submit\";\n\nexport const AutofillOverlayVisibility = {\n  Off: 0,\n  OnButtonClick: 1,\n  OnFieldFocus: 2,\n} as const;\n\nexport const BrowserClientVendors = {\n  Chrome: \"Chrome\",\n  Opera: \"Opera\",\n  Edge: \"Edge\",\n  Vivaldi: \"Vivaldi\",\n  Unknown: \"Unknown\",\n} as const;\n\nexport const BrowserShortcutsUris = {\n  Chrome: \"chrome://extensions/shortcuts\",\n  Opera: \"opera://extensions/shortcuts\",\n  Edge: \"edge://extensions/shortcuts\",\n  Vivaldi: \"vivaldi://extensions/shortcuts\",\n  Unknown: \"https://bitwarden.com/help/keyboard-shortcuts\",\n} as const;\n\nexport const DisablePasswordManagerUris = {\n  Chrome: \"chrome://settings/autofill\",\n  Opera: \"opera://settings/autofill\",\n  Edge: \"edge://settings/passwords\",\n  Vivaldi: \"vivaldi://settings/autofill\",\n  Unknown: \"https://bitwarden.com/help/disable-browser-autofill/\",\n} as const;\n\nexport const ExtensionCommand = {\n  AutofillCommand: \"autofill_cmd\",\n  AutofillCard: \"autofill_card\",\n  AutofillIdentity: \"autofill_identity\",\n  AutofillLogin: \"autofill_login\",\n  OpenAutofillOverlay: \"open_autofill_overlay\",\n  GeneratePassword: \"generate_password\",\n  OpenPopup: \"open_popup\",\n  LockVault: \"lock_vault\",\n  NoopCommand: \"noop\",\n} as const;\n\nexport type ExtensionCommandType = (typeof ExtensionCommand)[keyof typeof ExtensionCommand];\n\nexport const CLEAR_NOTIFICATION_LOGIN_DATA_DURATION = 60 * 1000; // 1 minute\n\nexport const MAX_DEEP_QUERY_RECURSION_DEPTH = 4;\n\nexport * from \"./match-patterns\";\n","// FIXME: update to use a const object instead of a typescript enum\n// eslint-disable-next-line @bitwarden/platform/no-enums\nexport enum ClientType {\n  Web = \"web\",\n  Browser = \"browser\",\n  Desktop = \"desktop\",\n  // Mobile = \"mobile\",\n  Cli = \"cli\",\n  // DirectoryConnector = \"connector\",\n}\n","// FIXME: update to use a const object instead of a typescript enum\n// eslint-disable-next-line @bitwarden/platform/no-enums\nexport enum DeviceType {\n  Android = 0,\n  iOS = 1,\n  ChromeExtension = 2,\n  FirefoxExtension = 3,\n  OperaExtension = 4,\n  EdgeExtension = 5,\n  WindowsDesktop = 6,\n  MacOsDesktop = 7,\n  LinuxDesktop = 8,\n  ChromeBrowser = 9,\n  FirefoxBrowser = 10,\n  OperaBrowser = 11,\n  EdgeBrowser = 12,\n  IEBrowser = 13,\n  UnknownBrowser = 14,\n  AndroidAmazon = 15,\n  UWP = 16,\n  SafariBrowser = 17,\n  VivaldiBrowser = 18,\n  VivaldiExtension = 19,\n  SafariExtension = 20,\n  SDK = 21,\n  Server = 22,\n  WindowsCLI = 23,\n  MacOsCLI = 24,\n  LinuxCLI = 25,\n  DuckDuckGoBrowser = 26,\n}\n\n/**\n * Device type metadata\n * Each device type has a category corresponding to the client type and platform (Android, iOS, Chrome, Firefox, etc.)\n */\ninterface DeviceTypeMetadata {\n  category: \"mobile\" | \"extension\" | \"webApp\" | \"desktop\" | \"cli\" | \"sdk\" | \"server\";\n  platform: string;\n}\n\nexport const DeviceTypeMetadata: Record<DeviceType, DeviceTypeMetadata> = {\n  [DeviceType.Android]: { category: \"mobile\", platform: \"Android\" },\n  [DeviceType.iOS]: { category: \"mobile\", platform: \"iOS\" },\n  [DeviceType.AndroidAmazon]: { category: \"mobile\", platform: \"Amazon\" },\n  [DeviceType.ChromeExtension]: { category: \"extension\", platform: \"Chrome\" },\n  [DeviceType.FirefoxExtension]: { category: \"extension\", platform: \"Firefox\" },\n  [DeviceType.OperaExtension]: { category: \"extension\", platform: \"Opera\" },\n  [DeviceType.EdgeExtension]: { category: \"extension\", platform: \"Edge\" },\n  [DeviceType.VivaldiExtension]: { category: \"extension\", platform: \"Vivaldi\" },\n  [DeviceType.SafariExtension]: { category: \"extension\", platform: \"Safari\" },\n  [DeviceType.ChromeBrowser]: { category: \"webApp\", platform: \"Chrome\" },\n  [DeviceType.FirefoxBrowser]: { category: \"webApp\", platform: \"Firefox\" },\n  [DeviceType.OperaBrowser]: { category: \"webApp\", platform: \"Opera\" },\n  [DeviceType.EdgeBrowser]: { category: \"webApp\", platform: \"Edge\" },\n  [DeviceType.IEBrowser]: { category: \"webApp\", platform: \"IE\" },\n  [DeviceType.SafariBrowser]: { category: \"webApp\", platform: \"Safari\" },\n  [DeviceType.VivaldiBrowser]: { category: \"webApp\", platform: \"Vivaldi\" },\n  [DeviceType.DuckDuckGoBrowser]: { category: \"webApp\", platform: \"DuckDuckGo\" },\n  [DeviceType.UnknownBrowser]: { category: \"webApp\", platform: \"Unknown\" },\n  [DeviceType.WindowsDesktop]: { category: \"desktop\", platform: \"Windows\" },\n  [DeviceType.MacOsDesktop]: { category: \"desktop\", platform: \"macOS\" },\n  [DeviceType.LinuxDesktop]: { category: \"desktop\", platform: \"Linux\" },\n  [DeviceType.UWP]: { category: \"desktop\", platform: \"Windows UWP\" },\n  [DeviceType.WindowsCLI]: { category: \"cli\", platform: \"Windows\" },\n  [DeviceType.MacOsCLI]: { category: \"cli\", platform: \"macOS\" },\n  [DeviceType.LinuxCLI]: { category: \"cli\", platform: \"Linux\" },\n  [DeviceType.SDK]: { category: \"sdk\", platform: \"\" },\n  [DeviceType.Server]: { category: \"server\", platform: \"\" },\n};\n","// Note: the enum key is used to describe the EventSystemUser in the UI. Be careful about changing it.\n// FIXME: update to use a const object instead of a typescript enum\n// eslint-disable-next-line @bitwarden/platform/no-enums\nexport enum EventSystemUser {\n  SCIM = 1,\n  DomainVerification = 2,\n  PublicApi = 3,\n}\n","// Increment by 100 for each new set of events\n// FIXME: update to use a const object instead of a typescript enum\n// eslint-disable-next-line @bitwarden/platform/no-enums\nexport enum EventType {\n  User_LoggedIn = 1000,\n  User_ChangedPassword = 1001,\n  User_Updated2fa = 1002,\n  User_Disabled2fa = 1003,\n  User_Recovered2fa = 1004,\n  User_FailedLogIn = 1005,\n  User_FailedLogIn2fa = 1006,\n  User_ClientExportedVault = 1007,\n  User_UpdatedTempPassword = 1008,\n  User_MigratedKeyToKeyConnector = 1009,\n  User_RequestedDeviceApproval = 1010,\n  User_TdeOffboardingPasswordSet = 1011,\n\n  Cipher_Created = 1100,\n  Cipher_Updated = 1101,\n  Cipher_Deleted = 1102,\n  Cipher_AttachmentCreated = 1103,\n  Cipher_AttachmentDeleted = 1104,\n  Cipher_Shared = 1105,\n  Cipher_UpdatedCollections = 1106,\n  Cipher_ClientViewed = 1107,\n  Cipher_ClientToggledPasswordVisible = 1108,\n  Cipher_ClientToggledHiddenFieldVisible = 1109,\n  Cipher_ClientToggledCardCodeVisible = 1110,\n  Cipher_ClientCopiedPassword = 1111,\n  Cipher_ClientCopiedHiddenField = 1112,\n  Cipher_ClientCopiedCardCode = 1113,\n  Cipher_ClientAutofilled = 1114,\n  Cipher_SoftDeleted = 1115,\n  Cipher_Restored = 1116,\n  Cipher_ClientToggledCardNumberVisible = 1117,\n  Cipher_ClientToggledTOTPSeedVisible = 1118,\n\n  Collection_Created = 1300,\n  Collection_Updated = 1301,\n  Collection_Deleted = 1302,\n\n  Group_Created = 1400,\n  Group_Updated = 1401,\n  Group_Deleted = 1402,\n\n  OrganizationUser_Invited = 1500,\n  OrganizationUser_Confirmed = 1501,\n  OrganizationUser_Updated = 1502,\n  OrganizationUser_Removed = 1503,\n  OrganizationUser_UpdatedGroups = 1504,\n  OrganizationUser_UnlinkedSso = 1505,\n  OrganizationUser_ResetPassword_Enroll = 1506,\n  OrganizationUser_ResetPassword_Withdraw = 1507,\n  OrganizationUser_AdminResetPassword = 1508,\n  OrganizationUser_ResetSsoLink = 1509,\n  OrganizationUser_FirstSsoLogin = 1510,\n  OrganizationUser_Revoked = 1511,\n  OrganizationUser_Restored = 1512,\n  OrganizationUser_ApprovedAuthRequest = 1513,\n  OrganizationUser_RejectedAuthRequest = 1514,\n  OrganizationUser_Deleted = 1515,\n  OrganizationUser_Left = 1516,\n\n  Organization_Updated = 1600,\n  Organization_PurgedVault = 1601,\n  Organization_ClientExportedVault = 1602,\n  Organization_VaultAccessed = 1603,\n  Organization_EnabledSso = 1604,\n  Organization_DisabledSso = 1605,\n  Organization_EnabledKeyConnector = 1606,\n  Organization_DisabledKeyConnector = 1607,\n  Organization_SponsorshipsSynced = 1608,\n  Organization_CollectionManagementUpdated = 1609,\n  Organization_CollectionManagement_LimitCollectionCreationEnabled = 1610,\n  Organization_CollectionManagement_LimitCollectionCreationDisabled = 1611,\n  Organization_CollectionManagement_LimitCollectionDeletionEnabled = 1612,\n  Organization_CollectionManagement_LimitCollectionDeletionDisabled = 1613,\n  Organization_CollectionManagement_LimitItemDeletionEnabled = 1614,\n  Organization_CollectionManagement_LimitItemDeletionDisabled = 1615,\n  Organization_CollectionManagement_AllowAdminAccessToAllCollectionItemsEnabled = 1616,\n  Organization_CollectionManagement_AllowAdminAccessToAllCollectionItemsDisabled = 1617,\n  Organization_ItemOrganization_Accepted = 1618,\n  Organization_ItemOrganization_Declined = 1619,\n\n  Policy_Updated = 1700,\n\n  ProviderUser_Invited = 1800,\n  ProviderUser_Confirmed = 1801,\n  ProviderUser_Updated = 1802,\n  ProviderUser_Removed = 1803,\n\n  ProviderOrganization_Created = 1900,\n  ProviderOrganization_Added = 1901,\n  ProviderOrganization_Removed = 1902,\n  ProviderOrganization_VaultAccessed = 1903,\n\n  OrganizationDomain_Added = 2000,\n  OrganizationDomain_Removed = 2001,\n  OrganizationDomain_Verified = 2002,\n  OrganizationDomain_NotVerified = 2003,\n\n  Secret_Retrieved = 2100,\n  Secret_Created = 2101,\n  Secret_Edited = 2102,\n  Secret_Deleted = 2103,\n  Secret_Permanently_Deleted = 2104,\n  Secret_Restored = 2105,\n\n  Project_Retrieved = 2200,\n  Project_Created = 2201,\n  Project_Edited = 2202,\n  Project_Deleted = 2203,\n\n  ServiceAccount_UserAdded = 2300,\n  ServiceAccount_UserRemoved = 2301,\n  ServiceAccount_GroupAdded = 2302,\n  ServiceAccount_GroupRemoved = 2303,\n  ServiceAccount_Created = 2304,\n  ServiceAccount_Deleted = 2305,\n}\n","/**\n * Hypertext Transfer Protocol (HTTP) response status codes.\n *\n * @see {@link https://en.wikipedia.org/wiki/List_of_HTTP_status_codes}\n * src: https://gist.github.com/RWOverdijk/6cef816cfdf5722228e01cc05fd4b094\n */\n// FIXME: update to use a const object instead of a typescript enum\n// eslint-disable-next-line @bitwarden/platform/no-enums\nexport enum HttpStatusCode {\n  /**\n   * The server has received the request headers and the client should proceed to send the request body\n   * (in the case of a request for which a body needs to be sent; for example, a POST request).\n   * Sending a large request body to a server after a request has been rejected for inappropriate headers would be inefficient.\n   * To have a server check the request's headers, a client must send Expect: 100-continue as a header in its initial request\n   * and receive a 100 Continue status code in response before sending the body. The response 417 Expectation Failed indicates the request should not be continued.\n   */\n  Continue = 100,\n\n  /**\n   * The requester has asked the server to switch protocols and the server has agreed to do so.\n   */\n  SwitchingProtocols = 101,\n\n  /**\n   * A WebDAV request may contain many sub-requests involving file operations, requiring a long time to complete the request.\n   * This code indicates that the server has received and is processing the request, but no response is available yet.\n   * This prevents the client from timing out and assuming the request was lost.\n   */\n  Processing = 102,\n\n  // **********************************************************************************************************\n  // 200s - SUCCESS\n  // **********************************************************************************************************\n\n  /**\n   * Standard response for successful HTTP requests.\n   * The actual response will depend on the request method used.\n   * In a GET request, the response will contain an entity corresponding to the requested resource.\n   * In a POST request, the response will contain an entity describing or containing the result of the action.\n   */\n  Ok = 200,\n\n  /**\n   * The request has been fulfilled, resulting in the creation of a new resource.\n   */\n  Created = 201,\n\n  /**\n   * The request has been accepted for processing, but the processing has not been completed.\n   * The request might or might not be eventually acted upon, and may be disallowed when processing occurs.\n   */\n  Accepted = 202,\n\n  /**\n   * SINCE HTTP/1.1\n   * The server is a transforming proxy that received a 200 OK from its origin,\n   * but is returning a modified version of the origin's response.\n   */\n  NonAuthoritativeInformation = 203,\n\n  /**\n   * The server successfully processed the request and is not returning any content.\n   */\n  NoContent = 204,\n\n  /**\n   * The server successfully processed the request, but is not returning any content.\n   * Unlike a 204 response, this response requires that the requester reset the document view.\n   */\n  ResetContent = 205,\n\n  /**\n   * The server is delivering only part of the resource (byte serving) due to a range header sent by the client.\n   * The range header is used by HTTP clients to enable resuming of interrupted downloads,\n   * or split a download into multiple simultaneous streams.\n   */\n  PartialContent = 206,\n\n  /**\n   * The message body that follows is an XML message and can contain a number of separate response codes,\n   * depending on how many sub-requests were made.\n   */\n  MultiStatus = 207,\n\n  /**\n   * The members of a DAV binding have already been enumerated in a preceding part of the (multistatus) response,\n   * and are not being included again.\n   */\n  AlreadyReported = 208,\n\n  /**\n   * The server has fulfilled a request for the resource,\n   * and the response is a representation of the result of one or more instance-manipulations applied to the current instance.\n   */\n  ImUsed = 226,\n\n  // **********************************************************************************************************\n  // 300s - Redirections\n  // **********************************************************************************************************\n\n  /**\n   * Indicates multiple options for the resource from which the client may choose (via agent-driven content negotiation).\n   * For example, this code could be used to present multiple video format options,\n   * to list files with different filename extensions, or to suggest word-sense disambiguation.\n   */\n  MultipleChoices = 300,\n\n  /**\n   * This and all future requests should be directed to the given URI.\n   */\n  MovedPermanently = 301,\n\n  /**\n   * This is an example of industry practice contradicting the standard.\n   * The HTTP/1.0 specification (RFC 1945) required the client to perform a temporary redirect\n   * (the original describing phrase was \"Moved Temporarily\"), but popular browsers implemented 302\n   * with the functionality of a 303 See Other. Therefore, HTTP/1.1 added status codes 303 and 307\n   * to distinguish between the two behaviours. However, some Web applications and frameworks\n   * use the 302 status code as if it were the 303.\n   */\n  Found = 302,\n\n  /**\n   * SINCE HTTP/1.1\n   * The response to the request can be found under another URI using a GET method.\n   * When received in response to a POST (or PUT/DELETE), the client should presume that\n   * the server has received the data and should issue a redirect with a separate GET message.\n   */\n  SeeOther = 303,\n\n  /**\n   * Indicates that the resource has not been modified since the version specified by the request headers If-Modified-Since or If-None-Match.\n   * In such case, there is no need to retransmit the resource since the client still has a previously-downloaded copy.\n   */\n  NotModified = 304,\n\n  /**\n   * SINCE HTTP/1.1\n   * The requested resource is available only through a proxy, the address for which is provided in the response.\n   * Many HTTP clients (such as Mozilla and Internet Explorer) do not correctly handle responses with this status code, primarily for security reasons.\n   */\n  UseProxy = 305,\n\n  /**\n   * No longer used. Originally meant \"Subsequent requests should use the specified proxy.\"\n   */\n  SwitchProxy = 306,\n\n  /**\n   * SINCE HTTP/1.1\n   * In this case, the request should be repeated with another URI; however, future requests should still use the original URI.\n   * In contrast to how 302 was historically implemented, the request method is not allowed to be changed when reissuing the original request.\n   * For example, a POST request should be repeated using another POST request.\n   */\n  TemporaryRedirect = 307,\n\n  /**\n   * The request and all future requests should be repeated using another URI.\n   * 307 and 308 parallel the behaviors of 302 and 301, but do not allow the HTTP method to change.\n   * So, for example, submitting a form to a permanently redirected resource may continue smoothly.\n   */\n  PermanentRedirect = 308,\n\n  // **********************************************************************************************************\n  // 400s - Client / User messed up\n  // **********************************************************************************************************\n\n  /**\n   * The server cannot or will not process the request due to an apparent client error\n   * (e.g., malformed request syntax, too large size, invalid request message framing, or deceptive request routing).\n   */\n  BadRequest = 400,\n\n  /**\n   * Similar to 403 Forbidden, but specifically for use when authentication is required and has failed or has not yet\n   * been provided. The response must include a WWW-Authenticate header field containing a challenge applicable to the\n   * requested resource. See Basic access authentication and Digest access authentication. 401 semantically means\n   * \"unauthenticated\",i.e. the user does not have the necessary credentials.\n   */\n  Unauthorized = 401,\n\n  /**\n   * Reserved for future use. The original intention was that this code might be used as part of some form of digital\n   * cash or micro payment scheme, but that has not happened, and this code is not usually used.\n   * Google Developers API uses this status if a particular developer has exceeded the daily limit on requests.\n   */\n  PaymentRequired = 402,\n\n  /**\n   * The request was valid, but the server is refusing action.\n   * The user might not have the necessary permissions for a resource.\n   */\n  Forbidden = 403,\n\n  /**\n   * The requested resource could not be found but may be available in the future.\n   * Subsequent requests by the client are permissible.\n   */\n  NotFound = 404,\n\n  /**\n   * A request method is not supported for the requested resource;\n   * for example, a GET request on a form that requires data to be presented via POST, or a PUT request on a read-only resource.\n   */\n  MethodNotAllowed = 405,\n\n  /**\n   * The requested resource is capable of generating only content not acceptable according to the Accept headers sent in the request.\n   */\n  NotAcceptable = 406,\n\n  /**\n   * The client must first authenticate itself with the proxy.\n   */\n  ProxyAuthenticationRequired = 407,\n\n  /**\n   * The server timed out waiting for the request.\n   * According to HTTP specifications:\n   * \"The client did not produce a request within the time that the server was prepared to wait. The client MAY repeat the request without modifications at any later time.\"\n   */\n  RequestTimeout = 408,\n\n  /**\n   * Indicates that the request could not be processed because of conflict in the request,\n   * such as an edit conflict between multiple simultaneous updates.\n   */\n  Conflict = 409,\n\n  /**\n   * Indicates that the resource requested is no longer available and will not be available again.\n   * This should be used when a resource has been intentionally removed and the resource should be purged.\n   * Upon receiving a 410 status code, the client should not request the resource in the future.\n   * Clients such as search engines should remove the resource from their indices.\n   * Most use cases do not require clients and search engines to purge the resource, and a \"404 Not Found\" may be used instead.\n   */\n  Gone = 410,\n\n  /**\n   * The request did not specify the length of its content, which is required by the requested resource.\n   */\n  LengthRequired = 411,\n\n  /**\n   * The server does not meet one of the preconditions that the requester put on the request.\n   */\n  PreconditionFailed = 412,\n\n  /**\n   * The request is larger than the server is willing or able to process. Previously called \"Request Entity Too Large\".\n   */\n  PayloadTooLarge = 413,\n\n  /**\n   * The URI provided was too long for the server to process. Often the result of too much data being encoded as a query-string of a GET request,\n   * in which case it should be converted to a POST request.\n   * Called \"Request-URI Too Long\" previously.\n   */\n  UriTooLong = 414,\n\n  /**\n   * The request entity has a media type which the server or resource does not support.\n   * For example, the client uploads an image as image/svg+xml, but the server requires that images use a different format.\n   */\n  UnsupportedMediaType = 415,\n\n  /**\n   * The client has asked for a portion of the file (byte serving), but the server cannot supply that portion.\n   * For example, if the client asked for a part of the file that lies beyond the end of the file.\n   * Called \"Requested Range Not Satisfiable\" previously.\n   */\n  RangeNotSatisfiable = 416,\n\n  /**\n   * The server cannot meet the requirements of the Expect request-header field.\n   */\n  ExpectationFailed = 417,\n\n  /**\n   * This code was defined in 1998 as one of the traditional IETF April Fools' jokes, in RFC 2324, Hyper Text Coffee Pot Control Protocol,\n   * and is not expected to be implemented by actual HTTP servers. The RFC specifies this code should be returned by\n   * teapots requested to brew coffee. This HTTP status is used as an Easter egg in some websites, including Google.com.\n   */\n  IAmATeapot = 418,\n\n  /**\n   * The request was directed at a server that is not able to produce a response (for example because a connection reuse).\n   */\n  MisdirectedRequest = 421,\n\n  /**\n   * The request was well-formed but was unable to be followed due to semantic errors.\n   */\n  UnprocessableEntity = 422,\n\n  /**\n   * The resource that is being accessed is locked.\n   */\n  Locked = 423,\n\n  /**\n   * The request failed due to failure of a previous request (e.g., a PROPPATCH).\n   */\n  FailedDependency = 424,\n\n  /**\n   * The client should switch to a different protocol such as TLS/1.0, given in the Upgrade header field.\n   */\n  UpgradeRequired = 426,\n\n  /**\n   * The origin server requires the request to be conditional.\n   * Intended to prevent \"the 'lost update' problem, where a client\n   * GETs a resource's state, modifies it, and PUTs it back to the server,\n   * when meanwhile a third party has modified the state on the server, leading to a conflict.\"\n   */\n  PreconditionRequired = 428,\n\n  /**\n   * The user has sent too many requests in a given amount of time. Intended for use with rate-limiting schemes.\n   */\n  TooManyRequests = 429,\n\n  /**\n   * The server is unwilling to process the request because either an individual header field,\n   * or all the header fields collectively, are too large.\n   */\n  RequestHeaderFieldsTooLarge = 431,\n\n  /**\n   * A server operator has received a legal demand to deny access to a resource or to a set of resources\n   * that includes the requested resource. The code 451 was chosen as a reference to the novel Fahrenheit 451.\n   */\n  UnavailableForLegalReasons = 451,\n\n  // **********************************************************************************************************\n  // 500s - Server messed up\n  // **********************************************************************************************************\n\n  /**\n   * A generic error message, given when an unexpected condition was encountered and no more specific message is suitable.\n   */\n  InternalServerError = 500,\n\n  /**\n   * The server either does not recognize the request method, or it lacks the ability to fulfill the request.\n   * Usually this implies future availability (e.g., a new feature of a web-service API).\n   */\n  NotImplemented = 501,\n\n  /**\n   * The server was acting as a gateway or proxy and received an invalid response from the upstream server.\n   */\n  BadGateway = 502,\n\n  /**\n   * The server is currently unavailable (because it is overloaded or down for maintenance).\n   * Generally, this is a temporary state.\n   */\n  ServiceUnavailable = 503,\n\n  /**\n   * The server was acting as a gateway or proxy and did not receive a timely response from the upstream server.\n   */\n  GatewayTimeout = 504,\n\n  /**\n   * The server does not support the HTTP protocol version used in the request\n   */\n  HttpVersionNotSupported = 505,\n\n  /**\n   * Transparent content negotiation for the request results in a circular reference.\n   */\n  VariantAlsoNegotiates = 506,\n\n  /**\n   * The server is unable to store the representation needed to complete the request.\n   */\n  InsufficientStorage = 507,\n\n  /**\n   * The server detected an infinite loop while processing the request.\n   */\n  LoopDetected = 508,\n\n  /**\n   * Further extensions to the request are required for the server to fulfill it.\n   */\n  NotExtended = 510,\n\n  /**\n   * The client needs to authenticate to gain network access.\n   * Intended for use by intercepting proxies used to control access to the network (e.g., \"captive portals\" used\n   * to require agreement to Terms of Service before granting full Internet access via a Wi-Fi hotspot).\n   */\n  NetworkAuthenticationRequired = 511,\n}\n","// FIXME: update to use a const object instead of a typescript enum\n// eslint-disable-next-line @bitwarden/platform/no-enums\nexport enum IntegrationType {\n  Integration = \"integration\",\n  SDK = \"sdk\",\n  SSO = \"sso\",\n  SCIM = \"scim\",\n  BWDC = \"bwdc\",\n  EVENT = \"event\",\n  DEVICE = \"device\",\n}\n","// FIXME: update to use a const object instead of a typescript enum\n// eslint-disable-next-line @bitwarden/platform/no-enums\nexport enum NativeMessagingVersion {\n  One = 1, // Original implementation\n  Latest = One,\n}\n","// FIXME: update to use a const object instead of a typescript enum\n// eslint-disable-next-line @bitwarden/platform/no-enums\nexport enum NotificationType {\n  SyncCipherUpdate = 0,\n  SyncCipherCreate = 1,\n  SyncLoginDelete = 2,\n  SyncFolderDelete = 3,\n  SyncCiphers = 4,\n\n  SyncVault = 5,\n  SyncOrgKeys = 6,\n  SyncFolderCreate = 7,\n  SyncFolderUpdate = 8,\n  SyncCipherDelete = 9,\n  SyncSettings = 10,\n\n  LogOut = 11,\n\n  SyncSendCreate = 12,\n  SyncSendUpdate = 13,\n  SyncSendDelete = 14,\n\n  AuthRequest = 15,\n  AuthRequestResponse = 16,\n\n  SyncOrganizations = 17,\n  SyncOrganizationStatusChanged = 18,\n  SyncOrganizationCollectionSettingChanged = 19,\n  Notification = 20,\n  NotificationStatus = 21,\n\n  RefreshSecurityTasks = 22,\n\n  OrganizationBankAccountVerified = 23,\n  ProviderBankAccountVerified = 24,\n\n  SyncPolicy = 25,\n}\n","export const PushNotificationLogOutReasonType = Object.freeze({\n  KdfChange: 0,\n} as const);\n\nexport type PushNotificationLogOutReasonType =\n  (typeof PushNotificationLogOutReasonType)[keyof typeof PushNotificationLogOutReasonType];\n","import { BrowserApi } from \"../platform/browser/browser-api\";\n\nexport class SafariApp {\n  static sendMessageToApp(command: string, data: any = null, resolveNow = false): Promise<any> {\n    if (!BrowserApi.isSafariApi) {\n      return Promise.resolve(null);\n    }\n    return new Promise((resolve) => {\n      const now = new Date();\n      const messageId =\n        now.getTime().toString() + \"_\" + Math.floor(Math.random() * Number.MAX_SAFE_INTEGER);\n      (browser as any).runtime.sendNativeMessage(\n        \"com.bitwarden.desktop\",\n        {\n          id: messageId,\n          command: command,\n          data: data,\n          responseData: null,\n        },\n        (response: any) => {\n          resolve(response);\n        },\n      );\n    });\n  }\n}\n","import { ConsoleLogService } from \"@bitwarden/common/platform/services/console-log.service\";\n\nclass BrowserClipboardService {\n  private static consoleLogService: ConsoleLogService = new ConsoleLogService(false);\n\n  /**\n   * Copies the given text to the user's clipboard.\n   *\n   * @param globalContext - The global window context.\n   * @param text - The text to copy.\n   */\n  static async copy(globalContext: Window, text: string) {\n    if (!BrowserClipboardService.isClipboardApiSupported(globalContext, \"writeText\")) {\n      this.useLegacyCopyMethod(globalContext, text);\n      return;\n    }\n\n    try {\n      await globalContext.navigator.clipboard.writeText(text);\n    } catch (error) {\n      BrowserClipboardService.consoleLogService.debug(\n        `Error copying to clipboard using the clipboard API, attempting legacy method: ${error}`,\n      );\n\n      this.useLegacyCopyMethod(globalContext, text);\n    }\n  }\n\n  /**\n   * Reads the user's clipboard and returns the text.\n   *\n   * @param globalContext - The global window context.\n   */\n  static async read(globalContext: Window): Promise<string> {\n    if (!BrowserClipboardService.isClipboardApiSupported(globalContext, \"readText\")) {\n      return this.useLegacyReadMethod(globalContext);\n    }\n\n    try {\n      return await globalContext.navigator.clipboard.readText();\n    } catch (error) {\n      BrowserClipboardService.consoleLogService.debug(\n        `Error reading from clipboard using the clipboard API, attempting legacy method: ${error}`,\n      );\n\n      return this.useLegacyReadMethod(globalContext);\n    }\n  }\n\n  /**\n   * Copies the given text to the user's clipboard using the legacy `execCommand` method. This\n   * method is used as a fallback when the clipboard API is not supported or fails.\n   *\n   * @param globalContext - The global window context.\n   * @param text - The text to copy.\n   */\n  private static useLegacyCopyMethod(globalContext: Window, text: string) {\n    if (!BrowserClipboardService.isLegacyClipboardMethodSupported(globalContext, \"copy\")) {\n      BrowserClipboardService.consoleLogService.warning(\"Legacy copy method not supported\");\n      return;\n    }\n\n    const textareaElement = globalContext.document.createElement(\"textarea\");\n    textareaElement.textContent = !text ? \" \" : text;\n    textareaElement.style.position = \"fixed\";\n    globalContext.document.body.appendChild(textareaElement);\n    textareaElement.select();\n\n    try {\n      globalContext.document.execCommand(\"copy\");\n    } catch (error) {\n      BrowserClipboardService.consoleLogService.warning(`Error writing to clipboard: ${error}`);\n    } finally {\n      globalContext.document.body.removeChild(textareaElement);\n    }\n  }\n\n  /**\n   * Reads the user's clipboard using the legacy `execCommand` method. This method is used as a\n   * fallback when the clipboard API is not supported or fails.\n   *\n   * @param globalContext - The global window context.\n   */\n  private static useLegacyReadMethod(globalContext: Window): string {\n    if (!BrowserClipboardService.isLegacyClipboardMethodSupported(globalContext, \"paste\")) {\n      BrowserClipboardService.consoleLogService.warning(\"Legacy paste method not supported\");\n      return \"\";\n    }\n\n    const textareaElement = globalContext.document.createElement(\"textarea\");\n    textareaElement.style.position = \"fixed\";\n    globalContext.document.body.appendChild(textareaElement);\n    textareaElement.focus();\n\n    try {\n      return globalContext.document.execCommand(\"paste\") ? textareaElement.value : \"\";\n    } catch (error) {\n      BrowserClipboardService.consoleLogService.warning(`Error reading from clipboard: ${error}`);\n    } finally {\n      globalContext.document.body.removeChild(textareaElement);\n    }\n\n    return \"\";\n  }\n\n  /**\n   * Checks if the clipboard API is supported in the current environment.\n   *\n   * @param globalContext - The global window context.\n   * @param method - The clipboard API method to check for support.\n   */\n  private static isClipboardApiSupported(globalContext: Window, method: \"writeText\" | \"readText\") {\n    return \"clipboard\" in globalContext.navigator && method in globalContext.navigator.clipboard;\n  }\n\n  /**\n   * Checks if the legacy clipboard method is supported in the current environment.\n   *\n   * @param globalContext - The global window context.\n   * @param method - The legacy clipboard method to check for support.\n   */\n  private static isLegacyClipboardMethodSupported(globalContext: Window, method: \"copy\" | \"paste\") {\n    return (\n      \"queryCommandSupported\" in globalContext.document &&\n      globalContext.document.queryCommandSupported(method)\n    );\n  }\n}\n\nexport default BrowserClipboardService;\n","// FIXME: Update this file to be type safe and remove this and next line\n// @ts-strict-ignore\nimport { ExtensionCommand } from \"@bitwarden/common/autofill/constants\";\nimport { ClientType, DeviceType } from \"@bitwarden/common/enums\";\nimport {\n  ClipboardOptions,\n  PlatformUtilsService,\n} from \"@bitwarden/common/platform/abstractions/platform-utils.service\";\n\nimport { SafariApp } from \"../../../browser/safariApp\";\nimport { BrowserApi } from \"../../browser/browser-api\";\nimport { OffscreenDocumentService } from \"../../offscreen-document/abstractions/offscreen-document\";\nimport BrowserClipboardService from \"../browser-clipboard.service\";\n\nexport abstract class BrowserPlatformUtilsService implements PlatformUtilsService {\n  private static deviceCache: DeviceType = null;\n\n  constructor(\n    private clipboardWriteCallback: (clipboardValue: string, clearMs: number) => void,\n    private globalContext: Window | ServiceWorkerGlobalScope,\n    private offscreenDocumentService: OffscreenDocumentService,\n  ) {}\n\n  static getDevice(globalContext: Window | ServiceWorkerGlobalScope): DeviceType {\n    if (this.deviceCache) {\n      return this.deviceCache;\n    }\n\n    // ORDERING MATTERS HERE\n    // Ordered from most specific to least specific. We try to discern the greatest detail\n    // for the type of extension the user is on by checking specific cases first and as we go down\n    // the list we hope to catch all by the most generic clients they could be on.\n    if (BrowserPlatformUtilsService.isFirefox()) {\n      this.deviceCache = DeviceType.FirefoxExtension;\n    } else if (BrowserPlatformUtilsService.isOpera(globalContext)) {\n      this.deviceCache = DeviceType.OperaExtension;\n    } else if (BrowserPlatformUtilsService.isEdge()) {\n      this.deviceCache = DeviceType.EdgeExtension;\n    } else if (BrowserPlatformUtilsService.isVivaldi()) {\n      this.deviceCache = DeviceType.VivaldiExtension;\n    } else if (BrowserPlatformUtilsService.isChrome(globalContext)) {\n      this.deviceCache = DeviceType.ChromeExtension;\n    } else if (BrowserPlatformUtilsService.isSafari(globalContext)) {\n      this.deviceCache = DeviceType.SafariExtension;\n    }\n\n    return this.deviceCache;\n  }\n\n  getDevice(): DeviceType {\n    return BrowserPlatformUtilsService.getDevice(this.globalContext);\n  }\n\n  getDeviceString(): string {\n    const device = DeviceType[this.getDevice()].toLowerCase();\n    return device.replace(\"extension\", \"\");\n  }\n\n  getClientType(): ClientType {\n    return ClientType.Browser;\n  }\n\n  private static isFirefox(): boolean {\n    return (\n      navigator.userAgent.indexOf(\" Firefox/\") !== -1 ||\n      navigator.userAgent.indexOf(\" Gecko/\") !== -1\n    );\n  }\n\n  isFirefox(): boolean {\n    return this.getDevice() === DeviceType.FirefoxExtension;\n  }\n\n  private static isChrome(globalContext: Window | ServiceWorkerGlobalScope): boolean {\n    return globalContext.chrome && navigator.userAgent.indexOf(\" Chrome/\") !== -1;\n  }\n\n  isChrome(): boolean {\n    return this.getDevice() === DeviceType.ChromeExtension;\n  }\n\n  private static isEdge(): boolean {\n    return navigator.userAgent.indexOf(\" Edg/\") !== -1;\n  }\n\n  isEdge(): boolean {\n    return this.getDevice() === DeviceType.EdgeExtension;\n  }\n\n  private static isOpera(globalContext: Window | ServiceWorkerGlobalScope): boolean {\n    return (\n      !!globalContext.opr?.addons ||\n      !!globalContext.opera ||\n      navigator.userAgent.indexOf(\" OPR/\") >= 0\n    );\n  }\n\n  isOpera(): boolean {\n    return this.getDevice() === DeviceType.OperaExtension;\n  }\n\n  private static isVivaldi(): boolean {\n    return navigator.userAgent.indexOf(\" Vivaldi/\") !== -1;\n  }\n\n  isVivaldi(): boolean {\n    return this.getDevice() === DeviceType.VivaldiExtension;\n  }\n\n  private static isSafari(globalContext: Window | ServiceWorkerGlobalScope): boolean {\n    // Opera masquerades as Safari, so make sure we're not there first\n    return (\n      !BrowserPlatformUtilsService.isOpera(globalContext) &&\n      navigator.userAgent.indexOf(\" Safari/\") !== -1\n    );\n  }\n\n  private static safariVersion(): string {\n    return navigator.userAgent.match(\"Version/([0-9.]*)\")?.[1];\n  }\n\n  isSafari(): boolean {\n    return this.getDevice() === DeviceType.SafariExtension;\n  }\n\n  isChromium(): boolean {\n    return this.isChrome() || this.isEdge() || this.isOpera() || this.isVivaldi();\n  }\n\n  /**\n   * Safari previous to version 16.1 had a bug which caused artifacts on hover in large extension popups.\n   * https://bugs.webkit.org/show_bug.cgi?id=218704\n   */\n  static shouldApplySafariHeightFix(globalContext: Window | ServiceWorkerGlobalScope): boolean {\n    if (BrowserPlatformUtilsService.getDevice(globalContext) !== DeviceType.SafariExtension) {\n      return false;\n    }\n\n    const version = BrowserPlatformUtilsService.safariVersion();\n    const parts = version?.split(\".\")?.map((v) => Number(v));\n    return parts?.[0] < 16 || (parts?.[0] === 16 && parts?.[1] === 0);\n  }\n\n  isIE(): boolean {\n    return false;\n  }\n\n  isMacAppStore(): boolean {\n    return false;\n  }\n\n  /**\n   * Identifies if the vault popup is currently open. This is done by sending a\n   * message to the popup and waiting for a response. If a response is received,\n   * the view is open.\n   */\n  async isPopupOpen(): Promise<boolean> {\n    if (this.isSafari()) {\n      // Query views on safari since chrome.runtime.sendMessage does not timeout and will hang.\n      return BrowserApi.isPopupOpen();\n    }\n\n    return new Promise<boolean>((resolve, reject) => {\n      chrome.runtime.sendMessage({ command: \"checkVaultPopupHeartbeat\" }, (response) => {\n        if (chrome.runtime.lastError != null) {\n          // This error means that nothing was there to listen to the message,\n          // meaning the view is not open.\n          if (\n            chrome.runtime.lastError.message ===\n            \"Could not establish connection. Receiving end does not exist.\"\n          ) {\n            resolve(false);\n            return;\n          }\n\n          // All unhandled errors still reject\n          reject(chrome.runtime.lastError);\n          return;\n        }\n\n        resolve(Boolean(response));\n      });\n    });\n  }\n\n  lockTimeout(): number {\n    return null;\n  }\n\n  launchUri(uri: string, options?: any): void {\n    // FIXME: Verify that this floating promise is intentional. If it is, add an explanatory comment and ensure there is proper error handling.\n    // eslint-disable-next-line @typescript-eslint/no-floating-promises\n    BrowserApi.createNewTab(uri, options && options.extensionPage === true);\n  }\n\n  getApplicationVersion(): Promise<string> {\n    const manifest = chrome.runtime.getManifest();\n    return Promise.resolve(manifest.version_name ?? manifest.version);\n  }\n\n  getApplicationVersionNumber(): Promise<string> {\n    const manifest = chrome.runtime.getManifest();\n    return Promise.resolve(manifest.version.split(RegExp(\"[+|-]\"))[0].trim());\n  }\n\n  supportsWebAuthn(win: Window): boolean {\n    return typeof PublicKeyCredential !== \"undefined\";\n  }\n\n  supportsDuo(): boolean {\n    return true;\n  }\n\n  supportsAutofill(): boolean {\n    return true;\n  }\n\n  supportsFileDownloads(): boolean {\n    return false;\n  }\n\n  abstract showToast(\n    type: \"error\" | \"success\" | \"warning\" | \"info\",\n    title: string,\n    text: string | string[],\n    options?: any,\n  ): void;\n\n  isDev(): boolean {\n    return process.env.ENV === \"development\";\n  }\n\n  isSelfHost(): boolean {\n    return false;\n  }\n\n  /**\n   * Copies the passed text to the clipboard. For Safari, this will use\n   * the native messaging API to send the text to the Bitwarden app. If\n   * the extension is using manifest v3, the offscreen document API will\n   * be used to copy the text to the clipboard. Otherwise, the browser's\n   * clipboard API will be used.\n   *\n   * @param text - The text to copy to the clipboard.\n   * @param options - Options for the clipboard operation.\n   */\n  copyToClipboard(text: string, options?: ClipboardOptions): void {\n    const windowContext = options?.window || (this.globalContext as Window);\n    const clearing = Boolean(options?.clearing);\n    const clearMs: number = options?.clearMs || null;\n    const handleClipboardWriteCallback = () => {\n      if (!clearing && this.clipboardWriteCallback != null) {\n        this.clipboardWriteCallback(text, clearMs);\n      }\n    };\n\n    if (this.isSafari()) {\n      void SafariApp.sendMessageToApp(\"copyToClipboard\", text).then(handleClipboardWriteCallback);\n\n      return;\n    }\n\n    if (this.isChrome() && text === \"\") {\n      text = \"\\u0000\";\n    }\n\n    if (BrowserApi.isManifestVersion(3) && this.offscreenDocumentService.offscreenApiSupported()) {\n      void this.triggerOffscreenCopyToClipboard(text).then(handleClipboardWriteCallback);\n\n      return;\n    }\n\n    void BrowserClipboardService.copy(windowContext, text).then(handleClipboardWriteCallback);\n  }\n\n  /**\n   * Reads the text from the clipboard. For Safari, this will use the\n   * native messaging API to request the text from the Bitwarden app. If\n   * the extension is using manifest v3, the offscreen document API will\n   * be used to read the text from the clipboard. Otherwise, the browser's\n   * clipboard API will be used.\n   *\n   * @param options - Options for the clipboard operation.\n   */\n  async readFromClipboard(options?: ClipboardOptions): Promise<string> {\n    const windowContext = options?.window || (this.globalContext as Window);\n\n    if (this.isSafari()) {\n      return await SafariApp.sendMessageToApp(\"readFromClipboard\");\n    }\n\n    if (BrowserApi.isManifestVersion(3) && this.offscreenDocumentService.offscreenApiSupported()) {\n      return await this.triggerOffscreenReadFromClipboard();\n    }\n\n    return await BrowserClipboardService.read(windowContext);\n  }\n\n  supportsSecureStorage(): boolean {\n    return false;\n  }\n\n  async getAutofillKeyboardShortcut(): Promise<string> {\n    let autofillCommand: string;\n    // You can not change the command in Safari or obtain it programmatically\n    if (this.isSafari()) {\n      autofillCommand = \"Cmd+Shift+L\";\n    } else if (this.isFirefox()) {\n      autofillCommand = (await browser.commands.getAll()).find(\n        (c) => c.name === ExtensionCommand.AutofillLogin,\n      ).shortcut;\n      // Firefox is returning Ctrl instead of Cmd for the modifier key on macOS if\n      // the command is the default one set on installation.\n      if (\n        (await browser.runtime.getPlatformInfo()).os === \"mac\" &&\n        autofillCommand === \"Ctrl+Shift+L\"\n      ) {\n        autofillCommand = \"Cmd+Shift+L\";\n      }\n    } else {\n      await new Promise((resolve) =>\n        chrome.commands.getAll((c) =>\n          resolve(\n            (autofillCommand = c.find((c) => c.name === ExtensionCommand.AutofillLogin).shortcut),\n          ),\n        ),\n      );\n    }\n    return autofillCommand;\n  }\n\n  async packageType(): Promise<string | null> {\n    switch (this.getDevice()) {\n      case DeviceType.ChromeExtension:\n        return \"Chrome Extension\";\n      case DeviceType.FirefoxExtension:\n        return \"Firefox Extension\";\n      case DeviceType.OperaExtension:\n        return \"Opera Extension\";\n      case DeviceType.EdgeExtension:\n        return \"Edge Extension\";\n      case DeviceType.VivaldiExtension:\n        return \"Vivaldi Extension\";\n      case DeviceType.SafariExtension:\n        return \"Safari Extension\";\n      default:\n        return \"Unknown Browser Extension\";\n    }\n  }\n\n  /**\n   * Triggers the offscreen document API to copy the text to the clipboard.\n   */\n  private async triggerOffscreenCopyToClipboard(text: string) {\n    await this.offscreenDocumentService.withDocument(\n      [chrome.offscreen.Reason.CLIPBOARD],\n      \"Write text to the clipboard.\",\n      async () => {\n        await BrowserApi.sendMessageWithResponse(\"offscreenCopyToClipboard\", { text });\n      },\n    );\n  }\n\n  /**\n   * Triggers the offscreen document API to read the text from the clipboard.\n   */\n  private async triggerOffscreenReadFromClipboard() {\n    const response = await this.offscreenDocumentService.withDocument(\n      [chrome.offscreen.Reason.CLIPBOARD],\n      \"Read text from the clipboard.\",\n      async () => {\n        return await BrowserApi.sendMessageWithResponse(\"offscreenReadFromClipboard\");\n      },\n    );\n    if (typeof response === \"string\") {\n      return response;\n    }\n\n    return \"\";\n  }\n}\n","// FIXME: Update this file to be type safe and remove this and next line\n// @ts-strict-ignore\n/**\n * MIT License\n *\n * Copyright (c) Federico Brigante <me@fregante.com> (https://fregante.com)\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the \"Software\"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n *\n * @see https://github.com/fregante/content-scripts-register-polyfill\n * @version 4.0.2\n */\nimport { ConsoleLogService } from \"@bitwarden/common/platform/services/console-log.service\";\n\nimport { BrowserApi } from \"./browser-api\";\n\nlet registerContentScripts: (\n  contentScriptOptions: browser.contentScripts.RegisteredContentScriptOptions,\n  callback?: (registeredContentScript: browser.contentScripts.RegisteredContentScript) => void,\n) => Promise<browser.contentScripts.RegisteredContentScript>;\nexport async function registerContentScriptsPolyfill(\n  contentScriptOptions: browser.contentScripts.RegisteredContentScriptOptions,\n  callback?: (registeredContentScript: browser.contentScripts.RegisteredContentScript) => void,\n) {\n  if (!registerContentScripts) {\n    registerContentScripts = buildRegisterContentScriptsPolyfill();\n  }\n\n  return registerContentScripts(contentScriptOptions, callback);\n}\n\nfunction buildRegisterContentScriptsPolyfill() {\n  const logService = new ConsoleLogService(false);\n  const chromeProxy = globalThis.chrome && NestedProxy<typeof globalThis.chrome>(globalThis.chrome);\n  const patternValidationRegex =\n    /^(https?|wss?|file|ftp|\\*):\\/\\/(\\*|\\*\\.[^*/]+|[^*/]+)\\/.*$|^file:\\/\\/\\/.*$|^resource:\\/\\/(\\*|\\*\\.[^*/]+|[^*/]+)\\/.*$|^about:/;\n  const isFirefox = globalThis.navigator?.userAgent.includes(\"Firefox/\");\n  const gotScripting = Boolean(globalThis.chrome?.scripting);\n  const gotNavigation = typeof chrome === \"object\" && \"webNavigation\" in chrome;\n\n  function NestedProxy<T extends object>(target: T): T {\n    return new Proxy(target, {\n      get(target, prop) {\n        if (!target[prop as keyof T]) {\n          return;\n        }\n\n        if (typeof target[prop as keyof T] !== \"function\") {\n          return NestedProxy(target[prop as keyof T] as object);\n        }\n\n        return (...arguments_: any[]) =>\n          new Promise((resolve, reject) => {\n            (target[prop as keyof T] as CallableFunction)(...arguments_, (result: any) => {\n              if (chrome.runtime.lastError) {\n                reject(new Error(chrome.runtime.lastError.message));\n              } else {\n                resolve(result);\n              }\n            });\n          });\n      },\n    });\n  }\n\n  function assertValidPattern(matchPattern: string) {\n    if (!isValidPattern(matchPattern)) {\n      throw new Error(\n        `${matchPattern} is an invalid pattern, it must match ${String(patternValidationRegex)}`,\n      );\n    }\n  }\n\n  function isValidPattern(matchPattern: string) {\n    return matchPattern === \"<all_urls>\" || patternValidationRegex.test(matchPattern);\n  }\n\n  function getRawPatternRegex(matchPattern: string) {\n    assertValidPattern(matchPattern);\n    let [, protocol, host = \"\", pathname] = matchPattern.split(/(^[^:]+:[/][/])([^/]+)?/);\n    protocol = protocol\n      .replace(\"*\", isFirefox ? \"(https?|wss?)\" : \"https?\")\n      .replaceAll(/[/]/g, \"[/]\");\n\n    if (host === \"*\") {\n      host = \"[^/]+\";\n    } else if (host) {\n      host = host\n        .replace(/^[*][.]/, \"([^/]+.)*\")\n        .replaceAll(/[.]/g, \"[.]\")\n        .replace(/[*]$/, \"[^.]+\");\n    }\n\n    pathname = pathname\n      .replaceAll(/[/]/g, \"[/]\")\n      .replaceAll(/[.]/g, \"[.]\")\n      .replaceAll(/[*]/g, \".*\");\n\n    return \"^\" + protocol + host + \"(\" + pathname + \")?$\";\n  }\n\n  function patternToRegex(...matchPatterns: string[]) {\n    if (matchPatterns.length === 0) {\n      return /$./;\n    }\n\n    if (matchPatterns.includes(\"<all_urls>\")) {\n      // <all_urls> regex\n      return /^(https?|file|ftp):[/]+/;\n    }\n\n    if (matchPatterns.includes(\"*://*/*\")) {\n      // all stars regex\n      return isFirefox ? /^(https?|wss?):[/][/][^/]+([/].*)?$/ : /^https?:[/][/][^/]+([/].*)?$/;\n    }\n\n    return new RegExp(matchPatterns.map((x) => getRawPatternRegex(x)).join(\"|\"));\n  }\n\n  function castAllFramesTarget(target: number | { tabId: number; frameId: number }) {\n    if (typeof target === \"object\") {\n      return { ...target, allFrames: false };\n    }\n\n    return {\n      tabId: target,\n      frameId: undefined,\n      allFrames: true,\n    };\n  }\n\n  function castArray(possibleArray: any | any[]) {\n    if (Array.isArray(possibleArray)) {\n      return possibleArray;\n    }\n\n    return [possibleArray];\n  }\n\n  function createTarget(\n    tabId: number,\n    frameId: number | undefined,\n    allFrames: boolean,\n  ): chrome.scripting.InjectionTarget {\n    if (frameId === undefined) {\n      return {\n        tabId,\n        frameIds: undefined,\n        allFrames: allFrames,\n      };\n    } else {\n      return {\n        tabId,\n        frameIds: [frameId],\n        allFrames: undefined,\n      };\n    }\n  }\n\n  async function insertCSS(\n    {\n      tabId,\n      frameId,\n      files,\n      allFrames,\n      matchAboutBlank,\n      runAt,\n    }: {\n      tabId: number;\n      frameId?: number;\n      files: browser.extensionTypes.ExtensionFileOrCode[];\n      allFrames: boolean;\n      matchAboutBlank: boolean;\n      runAt: browser.extensionTypes.RunAt;\n    },\n    { ignoreTargetErrors }: { ignoreTargetErrors?: boolean } = {},\n  ) {\n    const everyInsertion = Promise.all(\n      files.map(async (content) => {\n        if (typeof content === \"string\") {\n          content = { file: content };\n        }\n\n        if (gotScripting) {\n          if (\"file\" in content) {\n            return chrome.scripting.insertCSS({\n              target: createTarget(tabId, frameId, allFrames),\n              files: [content.file],\n            });\n          } else {\n            return chrome.scripting.insertCSS({\n              target: createTarget(tabId, frameId, allFrames),\n              css: content.code,\n            });\n          }\n        }\n\n        return chromeProxy.tabs.insertCSS(tabId, {\n          ...content,\n          matchAboutBlank,\n          allFrames,\n          frameId,\n          runAt: runAt ?? \"document_start\",\n        });\n      }),\n    );\n\n    if (ignoreTargetErrors) {\n      await catchTargetInjectionErrors(everyInsertion);\n    } else {\n      await everyInsertion;\n    }\n  }\n  function assertNoCode(files: browser.extensionTypes.ExtensionFileOrCode[]) {\n    if (files.some((content) => \"code\" in content)) {\n      throw new Error(\"chrome.scripting does not support injecting strings of `code`\");\n    }\n  }\n\n  async function executeScript(\n    {\n      tabId,\n      frameId,\n      files,\n      allFrames,\n      matchAboutBlank,\n      runAt,\n    }: {\n      tabId: number;\n      frameId?: number;\n      files: browser.extensionTypes.ExtensionFileOrCode[];\n      allFrames: boolean;\n      matchAboutBlank: boolean;\n      runAt: browser.extensionTypes.RunAt;\n    },\n    { ignoreTargetErrors }: { ignoreTargetErrors?: boolean } = {},\n  ) {\n    const normalizedFiles = files.map((file) => (typeof file === \"string\" ? { file } : file));\n\n    if (gotScripting) {\n      assertNoCode(normalizedFiles);\n      const injection = chrome.scripting.executeScript({\n        target: createTarget(tabId, frameId, allFrames),\n        files: normalizedFiles.map(({ file }: { file: string }) => file),\n      });\n\n      if (ignoreTargetErrors) {\n        await catchTargetInjectionErrors(injection);\n      } else {\n        await injection;\n      }\n\n      return;\n    }\n\n    const executions = [];\n    for (const content of normalizedFiles) {\n      if (\"code\" in content) {\n        await executions.at(-1);\n      }\n\n      executions.push(\n        chromeProxy.tabs.executeScript(tabId, {\n          ...content,\n          matchAboutBlank,\n          allFrames,\n          frameId,\n          runAt,\n        }),\n      );\n    }\n\n    if (ignoreTargetErrors) {\n      await catchTargetInjectionErrors(Promise.all(executions));\n    } else {\n      await Promise.all(executions);\n    }\n  }\n\n  async function injectContentScript(\n    where: { tabId: number; frameId: number },\n    scripts: {\n      css: browser.extensionTypes.ExtensionFileOrCode[];\n      js: browser.extensionTypes.ExtensionFileOrCode[];\n      matchAboutBlank: boolean;\n      runAt: browser.extensionTypes.RunAt;\n    },\n    options = {},\n  ) {\n    const targets = castArray(where);\n    await Promise.all(\n      targets.map(async (target) =>\n        injectContentScriptInSpecificTarget(castAllFramesTarget(target), scripts, options),\n      ),\n    );\n  }\n\n  async function injectContentScriptInSpecificTarget(\n    { frameId, tabId, allFrames }: { frameId?: number; tabId: number; allFrames: boolean },\n    scripts: {\n      css: browser.extensionTypes.ExtensionFileOrCode[];\n      js: browser.extensionTypes.ExtensionFileOrCode[];\n      matchAboutBlank: boolean;\n      runAt: browser.extensionTypes.RunAt;\n    },\n    options = {},\n  ) {\n    const injections = castArray(scripts).flatMap((script) => [\n      insertCSS(\n        {\n          tabId,\n          frameId,\n          allFrames,\n          files: script.css ?? [],\n          matchAboutBlank: script.matchAboutBlank ?? script.match_about_blank,\n          runAt: script.runAt ?? script.run_at,\n        },\n        options,\n      ),\n      executeScript(\n        {\n          tabId,\n          frameId,\n          allFrames,\n          files: script.js ?? [],\n          matchAboutBlank: script.matchAboutBlank ?? script.match_about_blank,\n          runAt: script.runAt ?? script.run_at,\n        },\n        options,\n      ),\n    ]);\n    await Promise.all(injections);\n  }\n\n  async function catchTargetInjectionErrors(promise: Promise<any>) {\n    try {\n      await promise;\n    } catch (error) {\n      const targetErrors =\n        /^No frame with id \\d+ in tab \\d+.$|^No tab with id: \\d+.$|^The tab was closed.$|^The frame was removed.$/;\n      if (!targetErrors.test(error?.message)) {\n        throw error;\n      }\n    }\n  }\n\n  async function isOriginPermitted(url: string) {\n    return chromeProxy.permissions.contains({\n      origins: [new URL(url).origin + \"/*\"],\n    });\n  }\n\n  return async (\n    contentScriptOptions: browser.contentScripts.RegisteredContentScriptOptions,\n    callback: CallableFunction,\n  ) => {\n    const {\n      js = [],\n      css = [],\n      matchAboutBlank,\n      matches = [],\n      excludeMatches,\n      runAt,\n    } = contentScriptOptions;\n    let { allFrames } = contentScriptOptions;\n\n    if (gotNavigation) {\n      allFrames = false;\n    } else if (allFrames) {\n      logService.warning(\n        \"`allFrames: true` requires the `webNavigation` permission to work correctly: https://github.com/fregante/content-scripts-register-polyfill#permissions\",\n      );\n    }\n\n    if (matches.length === 0) {\n      throw new Error(\n        \"Type error for parameter contentScriptOptions (Error processing matches: Array requires at least 1 items; you have 0) for contentScripts.register.\",\n      );\n    }\n\n    await Promise.all(\n      matches.map(async (pattern: string) => {\n        if (!(await chromeProxy.permissions.contains({ origins: [pattern] }))) {\n          throw new Error(`Permission denied to register a content script for ${pattern}`);\n        }\n      }),\n    );\n\n    const matchesRegex = patternToRegex(...matches);\n    const excludeMatchesRegex = patternToRegex(\n      ...(excludeMatches !== null && excludeMatches !== void 0 ? excludeMatches : []),\n    );\n    const inject = async (url: string, tabId: number, frameId = 0) => {\n      if (\n        !matchesRegex.test(url) ||\n        excludeMatchesRegex.test(url) ||\n        !(await isOriginPermitted(url))\n      ) {\n        return;\n      }\n\n      await injectContentScript(\n        { tabId, frameId },\n        { css, js, matchAboutBlank, runAt },\n        { ignoreTargetErrors: true },\n      );\n    };\n    const tabListener = async (\n      tabId: number,\n      { status }: chrome.tabs.OnUpdatedInfo,\n      { url }: chrome.tabs.Tab,\n    ) => {\n      if (status === \"loading\" && url) {\n        void inject(url, tabId);\n      }\n    };\n    const navListener = async ({\n      tabId,\n      frameId,\n      url,\n    }: chrome.webNavigation.WebNavigationTransitionCallbackDetails) => {\n      void inject(url, tabId, frameId);\n    };\n\n    if (gotNavigation) {\n      BrowserApi.addListener(chrome.webNavigation.onCommitted, navListener);\n    } else {\n      BrowserApi.addListener(chrome.tabs.onUpdated, tabListener);\n    }\n\n    const registeredContentScript = {\n      async unregister() {\n        if (gotNavigation) {\n          chrome.webNavigation.onCommitted.removeListener(navListener);\n        } else {\n          chrome.tabs.onUpdated.removeListener(tabListener);\n        }\n      },\n    };\n\n    if (typeof callback === \"function\") {\n      callback(registeredContentScript);\n    }\n\n    return registeredContentScript;\n  };\n}\n","// FIXME: Update this file to be type safe and remove this and next line\n// @ts-strict-ignore\nimport { Observable } from \"rxjs\";\n\nimport { BrowserClientVendors } from \"@bitwarden/common/autofill/constants\";\nimport { BrowserClientVendor } from \"@bitwarden/common/autofill/types\";\nimport { DeviceType } from \"@bitwarden/common/enums\";\nimport { LogService } from \"@bitwarden/logging\";\nimport { isBrowserSafariApi } from \"@bitwarden/platform\";\n\nimport { TabMessage } from \"../../types/tab-messages\";\nimport { BrowserPlatformUtilsService } from \"../services/platform-utils/browser-platform-utils.service\";\n\nimport { registerContentScriptsPolyfill } from \"./browser-api.register-content-scripts-polyfill\";\n\nexport class BrowserApi {\n  static isWebExtensionsApi: boolean = typeof browser !== \"undefined\";\n  static isSafariApi: boolean = isBrowserSafariApi();\n  static isChromeApi: boolean = !BrowserApi.isSafariApi && typeof chrome !== \"undefined\";\n  static isFirefoxOnAndroid: boolean =\n    navigator.userAgent.indexOf(\"Firefox/\") !== -1 && navigator.userAgent.indexOf(\"Android\") !== -1;\n\n  static get manifestVersion() {\n    return chrome.runtime.getManifest().manifest_version;\n  }\n\n  /**\n   * Determines if the extension manifest version is the given version.\n   *\n   * @param expectedVersion - The expected manifest version to check against.\n   */\n  static isManifestVersion(expectedVersion: 2 | 3) {\n    return BrowserApi.manifestVersion === expectedVersion;\n  }\n\n  /**\n   * Helper method that attempts to distinguish whether a message sender is internal to the extension or not.\n   *\n   * Currently this is done through source origin matching, and frameId checking (only top-level frames are internal).\n   * @param sender a message sender\n   * @param logger an optional logger to log validation results\n   * @returns whether or not the sender appears to be internal to the extension\n   */\n  static senderIsInternal(\n    sender: chrome.runtime.MessageSender | undefined,\n    logger?: LogService,\n  ): boolean {\n    if (!sender?.origin) {\n      logger?.warning(\"[BrowserApi] Message sender has no origin\");\n      return false;\n    }\n    const extensionUrl =\n      (typeof chrome !== \"undefined\" && chrome.runtime?.getURL(\"\")) ||\n      (typeof browser !== \"undefined\" && browser.runtime?.getURL(\"\")) ||\n      \"\";\n\n    if (!extensionUrl) {\n      logger?.warning(\"[BrowserApi] Unable to determine extension URL\");\n      return false;\n    }\n\n    // Normalize both URLs by removing trailing slashes\n    const normalizedOrigin = sender.origin.replace(/\\/$/, \"\").toLowerCase();\n    const normalizedExtensionUrl = extensionUrl.replace(/\\/$/, \"\").toLowerCase();\n\n    if (!normalizedOrigin.startsWith(normalizedExtensionUrl)) {\n      logger?.warning(\n        `[BrowserApi] Message sender origin (${normalizedOrigin}) does not match extension URL (${normalizedExtensionUrl})`,\n      );\n      return false;\n    }\n\n    // We only send messages from the top-level frame, but frameId is only set if tab is set, which for popups it is not.\n    if (\"frameId\" in sender && sender.frameId !== 0) {\n      logger?.warning(\"[BrowserApi] Message sender is not from the top-level frame\");\n      return false;\n    }\n\n    logger?.info(\"[BrowserApi] Message sender appears to be internal\");\n    return true;\n  }\n\n  /**\n   * Gets all open browser windows, including their tabs.\n   *\n   * @returns A promise that resolves to an array of browser windows.\n   */\n  static async getWindows(): Promise<chrome.windows.Window[]> {\n    return new Promise((resolve) => chrome.windows.getAll({ populate: true }, resolve));\n  }\n\n  /**\n   * Gets the current window or the window with the given id.\n   *\n   * @param windowId - The id of the window to get. If not provided, the current window is returned.\n   */\n  static async getWindow(windowId?: number): Promise<chrome.windows.Window> {\n    if (!windowId) {\n      return BrowserApi.getCurrentWindow();\n    }\n\n    return await BrowserApi.getWindowById(windowId);\n  }\n\n  /**\n   * Gets the currently active browser window.\n   */\n  static async getCurrentWindow(): Promise<chrome.windows.Window> {\n    return new Promise((resolve) => chrome.windows.getCurrent({ populate: true }, resolve));\n  }\n\n  /**\n   * Gets the window with the given id.\n   *\n   * @param windowId - The id of the window to get.\n   */\n  static async getWindowById(windowId: number): Promise<chrome.windows.Window> {\n    return new Promise((resolve) => chrome.windows.get(windowId, { populate: true }, resolve));\n  }\n\n  static async createWindow(options: chrome.windows.CreateData): Promise<chrome.windows.Window> {\n    return new Promise((resolve) => {\n      chrome.windows.create(options, async (newWindow) => {\n        if (!BrowserApi.isSafariApi) {\n          return resolve(newWindow);\n        }\n        // Safari doesn't close the default extension popup when a new window is created so we need to\n        // manually trigger the close by focusing the main window after the new window is created\n        const allWindows = await new Promise<chrome.windows.Window[]>((resolve) => {\n          chrome.windows.getAll({ windowTypes: [\"normal\"] }, (windows) => resolve(windows));\n        });\n\n        const mainWindow = allWindows.find((window) => window.id !== newWindow.id);\n\n        // No main window found, resolve the new window\n        if (mainWindow == null || !mainWindow.id) {\n          return resolve(newWindow);\n        }\n\n        // Focus the main window to close the extension popup\n        chrome.windows.update(mainWindow.id, { focused: true }, () => {\n          // Refocus the newly created window\n          chrome.windows.update(newWindow.id, { focused: true }, () => {\n            resolve(newWindow);\n          });\n        });\n      });\n    });\n  }\n\n  /**\n   * Removes the window with the given id.\n   *\n   * @param windowId - The id of the window to remove.\n   */\n  static async removeWindow(windowId: number): Promise<void> {\n    return new Promise((resolve) => chrome.windows.remove(windowId, () => resolve()));\n  }\n\n  /**\n   * Updates the properties of the window with the given id.\n   *\n   * @param windowId - The id of the window to update.\n   * @param options - The window properties to update.\n   */\n  static async updateWindowProperties(\n    windowId: number,\n    options: chrome.windows.UpdateInfo,\n  ): Promise<void> {\n    return new Promise((resolve) =>\n      chrome.windows.update(windowId, options, () => {\n        resolve();\n      }),\n    );\n  }\n\n  /**\n   * Focuses the window with the given id.\n   *\n   * @param windowId - The id of the window to focus.\n   */\n  static async focusWindow(windowId: number) {\n    await BrowserApi.updateWindowProperties(windowId, { focused: true });\n  }\n\n  static async getTabFromCurrentWindowId(): Promise<chrome.tabs.Tab> | null {\n    return await BrowserApi.tabsQueryFirstCurrentWindowForSafari({\n      active: true,\n      windowId: chrome.windows.WINDOW_ID_CURRENT,\n    });\n  }\n\n  static getBrowserClientVendor(clientWindow: Window): BrowserClientVendor {\n    const device = BrowserPlatformUtilsService.getDevice(clientWindow);\n\n    switch (device) {\n      case DeviceType.ChromeExtension:\n      case DeviceType.ChromeBrowser:\n        return BrowserClientVendors.Chrome;\n      case DeviceType.OperaExtension:\n      case DeviceType.OperaBrowser:\n        return BrowserClientVendors.Opera;\n      case DeviceType.EdgeExtension:\n      case DeviceType.EdgeBrowser:\n        return BrowserClientVendors.Edge;\n      case DeviceType.VivaldiExtension:\n      case DeviceType.VivaldiBrowser:\n        return BrowserClientVendors.Vivaldi;\n      default:\n        return BrowserClientVendors.Unknown;\n    }\n  }\n\n  /**\n   * Gets the tab with the given id.\n   *\n   * @param tabId - The id of the tab to get.\n   */\n  static async getTab(tabId: number): Promise<chrome.tabs.Tab> | null {\n    if (!tabId) {\n      return null;\n    }\n\n    if (BrowserApi.isManifestVersion(3)) {\n      return await chrome.tabs.get(tabId);\n    }\n\n    return new Promise((resolve) =>\n      chrome.tabs.get(tabId, (tab) => {\n        resolve(tab);\n      }),\n    );\n  }\n\n  static async getTabFromCurrentWindow(): Promise<chrome.tabs.Tab> | null {\n    return await BrowserApi.tabsQueryFirstCurrentWindowForSafari({\n      active: true,\n      currentWindow: true,\n    });\n  }\n\n  static async getActiveTabs(): Promise<chrome.tabs.Tab[]> {\n    return await BrowserApi.tabsQuery({\n      active: true,\n    });\n  }\n\n  /**\n   * Fetch the currently open browser tab\n   */\n  static async getCurrentTab(): Promise<chrome.tabs.Tab> | null {\n    if (BrowserApi.isManifestVersion(3)) {\n      return await chrome.tabs.getCurrent();\n    }\n\n    return new Promise((resolve) =>\n      chrome.tabs.getCurrent((tab) => {\n        resolve(tab);\n      }),\n    );\n  }\n\n  /**\n   * Closes a browser tab with the given id\n   *\n   * @param tabId The id of the tab to close\n   */\n  static async closeTab(tabId: number): Promise<void> {\n    if (tabId) {\n      if (BrowserApi.isWebExtensionsApi) {\n        await browser.tabs.remove(tabId).catch((error) => {\n          throw new Error(\"[BrowserApi] Failed to remove current tab: \" + error.message);\n        });\n      } else if (BrowserApi.isChromeApi) {\n        await chrome.tabs.remove(tabId).catch((error) => {\n          throw new Error(\"[BrowserApi] Failed to remove current tab: \" + error.message);\n        });\n      }\n    }\n  }\n\n  /**\n   * Navigates a browser tab to the given URL\n   *\n   * @param tabId The id of the tab to navigate\n   * @param url The URL to navigate to\n   */\n  static async navigateTabToUrl(tabId: number, url: URL): Promise<void> {\n    if (tabId) {\n      if (BrowserApi.isWebExtensionsApi) {\n        await browser.tabs.update(tabId, { url: url.href }).catch((error) => {\n          throw new Error(\"Failed to navigate tab to URL: \" + error.message);\n        });\n      } else if (BrowserApi.isChromeApi) {\n        chrome.tabs.update(tabId, { url: url.href }, () => {\n          if (chrome.runtime.lastError) {\n            throw new Error(\"Failed to navigate tab to URL: \" + chrome.runtime.lastError.message);\n          }\n        });\n      }\n    }\n  }\n\n  static async tabsQuery(options: chrome.tabs.QueryInfo): Promise<chrome.tabs.Tab[]> {\n    return new Promise((resolve) => {\n      chrome.tabs.query(options, (tabs) => {\n        resolve(tabs);\n      });\n    });\n  }\n\n  static async tabsQueryFirst(options: chrome.tabs.QueryInfo): Promise<chrome.tabs.Tab> | null {\n    const tabs = await BrowserApi.tabsQuery(options);\n    if (tabs.length > 0) {\n      return tabs[0];\n    }\n\n    return null;\n  }\n\n  /**\n   * Drop-in replacement for {@link BrowserApi.tabsQueryFirst}.\n   *\n   * Safari sometimes returns >1 tabs unexpectedly even when\n   * specifying a `windowId` or `currentWindow: true` query option.\n   *\n   * For all of these calls,\n   * ```\n   * await chrome.tabs.query({active: true, currentWindow: true})\n   * await chrome.tabs.query({active: true, windowId: chrome.windows.WINDOW_ID_CURRENT})\n   * await chrome.tabs.query({active: true, windowId: 10})\n   * ```\n   *\n   * Safari could return:\n   * ```\n   * [\n   *   {windowId: 2, pinned: true, title: \"Incorrect tab in another window\", },\n   *   {windowId: 10, title: \"Correct tab in foreground\", },\n   * ]\n   * ```\n   *\n   * This function captures the current window ID manually before running the query,\n   * then finds and returns the tab with the matching window ID.\n   *\n   * See the `SafariTabsQuery` tests in `browser-api.spec.ts`.\n   *\n   * This workaround can be removed when Safari fixes this bug.\n   */\n  static async tabsQueryFirstCurrentWindowForSafari(\n    options: chrome.tabs.QueryInfo,\n  ): Promise<chrome.tabs.Tab> | null {\n    if (!BrowserApi.isSafariApi) {\n      return await BrowserApi.tabsQueryFirst(options);\n    }\n\n    const currentWindowId = (await BrowserApi.getCurrentWindow()).id;\n    const tabs = await BrowserApi.tabsQuery(options);\n\n    if (tabs.length <= 1 || currentWindowId == null) {\n      return tabs[0];\n    }\n\n    return tabs.find((t) => t.windowId === currentWindowId) ?? tabs[0];\n  }\n\n  static tabSendMessageData(\n    tab: chrome.tabs.Tab,\n    command: string,\n    data: any = null,\n  ): Promise<void> {\n    const obj: any = {\n      command: command,\n    };\n\n    if (data != null) {\n      obj.data = data;\n    }\n\n    return BrowserApi.tabSendMessage(tab, obj);\n  }\n\n  static async tabSendMessage<T, TResponse = unknown>(\n    tab: chrome.tabs.Tab,\n    obj: T,\n    options: chrome.tabs.MessageSendOptions = null,\n    rejectOnError = false,\n  ): Promise<TResponse> {\n    if (!tab || !tab.id) {\n      return;\n    }\n\n    return new Promise<TResponse>((resolve, reject) => {\n      chrome.tabs.sendMessage(tab.id, obj, options, (response) => {\n        if (chrome.runtime.lastError && rejectOnError) {\n          // Some error happened\n          reject();\n        }\n        resolve(response);\n      });\n    });\n  }\n\n  static sendTabsMessage<T>(\n    tabId: number,\n    message: TabMessage,\n    options?: chrome.tabs.MessageSendOptions,\n    responseCallback?: (response: T) => void,\n  ) {\n    chrome.tabs.sendMessage<TabMessage, T>(tabId, message, options, responseCallback);\n  }\n\n  static getRuntimeURL(path: string): string {\n    if (BrowserApi.isWebExtensionsApi) {\n      return browser.runtime.getURL(path);\n    } else if (BrowserApi.isChromeApi) {\n      return chrome.runtime.getURL(path);\n    }\n  }\n\n  static async onWindowCreated(callback: (win: chrome.windows.Window) => any) {\n    // FIXME: Make sure that is does not cause a memory leak in Safari or use BrowserApi.AddListener\n    // and test that it doesn't break.\n    // eslint-disable-next-line no-restricted-syntax\n    return chrome.windows.onCreated.addListener(callback);\n  }\n\n  /**\n   * Gets the background page for the extension. This method is\n   * not valid within manifest v3 background service workers. As\n   * a result, it will return null when called from that context.\n   */\n  static getBackgroundPage(): any {\n    if (typeof chrome.extension.getBackgroundPage === \"undefined\") {\n      return null;\n    }\n\n    return chrome.extension.getBackgroundPage();\n  }\n\n  /**\n   * Accepts a window object and determines if it is\n   * associated with the background page of the extension.\n   *\n   * @param window - The window to check.\n   */\n  static isBackgroundPage(window: Window & typeof globalThis): boolean {\n    return typeof window !== \"undefined\" && window === BrowserApi.getBackgroundPage();\n  }\n\n  /**\n   * Gets the extension views that match the given properties. This method is not\n   * available within background service worker. As a result, it will return an\n   * empty array when called from that context.\n   *\n   * @param fetchProperties - The properties used to filter extension views.\n   */\n  static getExtensionViews(fetchProperties?: chrome.extension.FetchProperties): Window[] {\n    if (typeof chrome.extension.getViews === \"undefined\") {\n      return [];\n    }\n\n    return chrome.extension.getViews(fetchProperties);\n  }\n\n  /**\n   * Queries all extension views that are of type `popup`\n   * and returns whether any are currently open.\n   */\n  static async isPopupOpen(): Promise<boolean> {\n    return Promise.resolve(BrowserApi.getExtensionViews({ type: \"popup\" }).length > 0);\n  }\n\n  static createNewTab(url: string, active = true): Promise<chrome.tabs.Tab> {\n    return new Promise((resolve) =>\n      chrome.tabs.create({ url: url, active: active }, (tab) => resolve(tab)),\n    );\n  }\n\n  /**\n   * Gathers the details for a specified sub-frame of a tab.\n   *\n   * @param details - The details of the frame to get.\n   */\n  static async getFrameDetails(\n    details: chrome.webNavigation.GetFrameDetails,\n  ): Promise<chrome.webNavigation.GetFrameResultDetails> {\n    return new Promise((resolve) => chrome.webNavigation.getFrame(details, resolve));\n  }\n\n  /**\n   * Gets all frames associated with a tab.\n   *\n   * @param tabId - The id of the tab to get the frames for.\n   */\n  static async getAllFrameDetails(\n    tabId: chrome.tabs.Tab[\"id\"],\n  ): Promise<chrome.webNavigation.GetAllFrameResultDetails[]> {\n    return new Promise((resolve) => chrome.webNavigation.getAllFrames({ tabId }, resolve));\n  }\n\n  // Keep track of all the events registered in a Safari popup so we can remove\n  // them when the popup gets unloaded, otherwise we cause a memory leak\n  private static trackedChromeEventListeners: [\n    event: chrome.events.Event<(...args: unknown[]) => unknown>,\n    callback: (...args: unknown[]) => unknown,\n  ][] = [];\n\n  static messageListener(\n    name: string,\n    callback: (\n      message: any,\n      sender: chrome.runtime.MessageSender,\n      sendResponse: any,\n    ) => boolean | void,\n  ) {\n    BrowserApi.addListener(chrome.runtime.onMessage, callback);\n  }\n\n  static messageListener$() {\n    return new Observable<unknown>((subscriber) => {\n      const handler = (message: unknown) => {\n        subscriber.next(message);\n      };\n\n      BrowserApi.addListener(chrome.runtime.onMessage, handler);\n\n      return () => BrowserApi.removeListener(chrome.runtime.onMessage, handler);\n    });\n  }\n\n  static storageChangeListener(\n    callback: Parameters<typeof chrome.storage.onChanged.addListener>[0],\n  ) {\n    BrowserApi.addListener(chrome.storage.onChanged, callback);\n  }\n\n  /**\n   * Adds a callback to the given chrome event in a cross-browser platform manner.\n   *\n   * **Important:** All event listeners in the browser extension popup context must\n   * use this instead of the native APIs to handle unsubscribing from Safari properly.\n   *\n   * @param event - The event in which to add the listener to.\n   * @param callback - The callback you want registered onto the event.\n   */\n  static addListener<T extends (...args: readonly any[]) => any>(\n    event: chrome.events.Event<T>,\n    callback: T,\n  ) {\n    event.addListener(callback);\n\n    if (BrowserApi.isSafariApi && !BrowserApi.isBackgroundPage(self)) {\n      BrowserApi.trackedChromeEventListeners.push([event, callback]);\n      BrowserApi.setupUnloadListeners();\n    }\n  }\n\n  /**\n   * Removes a callback from the given chrome event in a cross-browser platform manner.\n   * @param event - The event in which to remove the listener from.\n   * @param callback - The callback you want removed from the event.\n   */\n  static removeListener<T extends (...args: readonly unknown[]) => unknown>(\n    event: chrome.events.Event<T>,\n    callback: T,\n  ) {\n    event.removeListener(callback);\n\n    if (BrowserApi.isSafariApi && !BrowserApi.isBackgroundPage(self)) {\n      const index = BrowserApi.trackedChromeEventListeners.findIndex(([_event, eventListener]) => {\n        return eventListener == callback;\n      });\n      if (index !== -1) {\n        BrowserApi.trackedChromeEventListeners.splice(index, 1);\n      }\n    }\n  }\n\n  // Setup the event to destroy all the listeners when the popup gets unloaded in Safari, otherwise we get a memory leak\n  private static setupUnloadListeners() {\n    // The MDN recommend using 'visibilitychange' but that event is fired any time the popup window is obscured as well\n    // 'pagehide' works just like 'unload' but is compatible with the back/forward cache, so we prefer using that one\n    self.addEventListener(\"pagehide\", () => {\n      for (const [event, callback] of BrowserApi.trackedChromeEventListeners) {\n        event.removeListener(callback);\n      }\n    });\n  }\n\n  static sendMessage(subscriber: string, arg: any = {}) {\n    const message = Object.assign({}, { command: subscriber }, arg);\n    return chrome.runtime.sendMessage(message);\n  }\n\n  static sendMessageWithResponse<TResponse>(subscriber: string, arg: any = {}) {\n    const message = Object.assign({}, { command: subscriber }, arg);\n    return new Promise<TResponse>((resolve) => chrome.runtime.sendMessage(message, resolve));\n  }\n\n  static async focusTab(tabId: number) {\n    // FIXME: Verify that this floating promise is intentional. If it is, add an explanatory comment and ensure there is proper error handling.\n    // eslint-disable-next-line @typescript-eslint/no-floating-promises\n    chrome.tabs.update(tabId, { active: true, highlighted: true });\n  }\n\n  static closePopup(win: Window) {\n    if (BrowserApi.isWebExtensionsApi && BrowserApi.isFirefoxOnAndroid) {\n      // Reactivating the active tab dismisses the popup tab. The promise final\n      // condition is only called if the popup wasn't already dismissed (future proofing).\n      // ref: https://bugzilla.mozilla.org/show_bug.cgi?id=1433604\n      // FIXME: Verify that this floating promise is intentional. If it is, add an explanatory comment and ensure there is proper error handling.\n      // eslint-disable-next-line @typescript-eslint/no-floating-promises\n      browser.tabs.update({ active: true }).finally(win.close);\n    } else {\n      win.close();\n    }\n  }\n\n  static gaFilter() {\n    return process.env.ENV !== \"production\";\n  }\n\n  static getUILanguage() {\n    return chrome.i18n.getUILanguage();\n  }\n\n  /**\n   * Handles reloading the extension using the underlying functionality exposed by the browser API.\n   */\n  static reloadExtension() {\n    // If we do `chrome.runtime.reload` on safari they will send an onInstalled reason of install\n    // and that prompts us to show a new tab, this apparently doesn't happen on sideloaded\n    // extensions and only shows itself production scenarios. See: https://bitwarden.atlassian.net/browse/PM-12298\n    if (this.isSafariApi) {\n      return self.location.reload();\n    }\n    return chrome.runtime.reload();\n  }\n\n  /**\n   * Reloads all open extension views, except the background page. Will also\n   * skip reloading the current window location if exemptCurrentHref is true.\n   *\n   * @param exemptCurrentHref - Whether to exempt the current window location from the reload.\n   */\n  static reloadOpenWindows(exemptCurrentHref = false) {\n    const views = BrowserApi.getExtensionViews();\n    if (!views.length) {\n      return;\n    }\n\n    const currentHref = self.location.href;\n    views\n      .filter((w) => w.location.href != null && !w.location.href.includes(\"background.html\"))\n      .filter((w) => !exemptCurrentHref || w.location.href !== currentHref)\n      .forEach((w) => w.location.reload());\n  }\n\n  static connectNative(application: string): browser.runtime.Port | chrome.runtime.Port {\n    if (BrowserApi.isWebExtensionsApi) {\n      return browser.runtime.connectNative(application);\n    } else if (BrowserApi.isChromeApi) {\n      return chrome.runtime.connectNative(application);\n    }\n  }\n\n  static requestPermission(permission: any) {\n    if (BrowserApi.isWebExtensionsApi) {\n      return browser.permissions.request(permission);\n    }\n    return new Promise((resolve) => {\n      chrome.permissions.request(permission, resolve);\n    });\n  }\n\n  /**\n   * Checks if the user has provided the given permissions to the extension.\n   *\n   * @param permissions - The permissions to check.\n   */\n  static async permissionsGranted(\n    permissions: chrome.runtime.ManifestPermissions[],\n  ): Promise<boolean> {\n    return new Promise((resolve) =>\n      chrome.permissions.contains({ permissions }, (result) => resolve(result)),\n    );\n  }\n\n  static getPlatformInfo(): Promise<browser.runtime.PlatformInfo | chrome.runtime.PlatformInfo> {\n    if (BrowserApi.isWebExtensionsApi) {\n      return browser.runtime.getPlatformInfo();\n    }\n    return new Promise((resolve) => {\n      chrome.runtime.getPlatformInfo(resolve);\n    });\n  }\n\n  /**\n   * Returns the supported BrowserAction API based on the manifest version.\n   */\n  static getBrowserAction() {\n    return BrowserApi.isManifestVersion(3) ? chrome.action : chrome.browserAction;\n  }\n\n  static getSidebarAction(\n    win: Window & typeof globalThis,\n  ): OperaSidebarAction | FirefoxSidebarAction | null {\n    const deviceType = BrowserPlatformUtilsService.getDevice(win);\n    if (deviceType === DeviceType.FirefoxExtension) {\n      return browser.sidebarAction;\n    }\n\n    if (deviceType === DeviceType.OperaExtension) {\n      return win.opr?.sidebarAction;\n    }\n\n    return null;\n  }\n\n  static captureVisibleTab(): Promise<string> {\n    return new Promise((resolve) => {\n      chrome.tabs.captureVisibleTab(null, { format: \"png\" }, resolve);\n    });\n  }\n\n  /**\n   * Extension API helper method used to execute a script in a tab.\n   *\n   * @see https://developer.chrome.com/docs/extensions/reference/tabs/#method-executeScript\n   * @param tabId - The id of the tab to execute the script in.\n   * @param details {@link \"InjectDetails\" https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/extensionTypes/InjectDetails}\n   * @param scriptingApiDetails {@link \"ExecutionWorld\" https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/scripting/ExecutionWorld}\n   */\n  static executeScriptInTab(\n    tabId: number,\n    details: chrome.extensionTypes.InjectDetails,\n    scriptingApiDetails?: {\n      world: chrome.scripting.ExecutionWorld;\n    },\n  ): Promise<unknown> {\n    if (BrowserApi.isManifestVersion(3)) {\n      let target: chrome.scripting.InjectionTarget;\n\n      if (typeof details.frameId === \"number\") {\n        target = { tabId, frameIds: [details.frameId] };\n      } else if (details.allFrames) {\n        target = { tabId, allFrames: true };\n      } else {\n        target = { tabId };\n      }\n\n      return chrome.scripting.executeScript({\n        target,\n        files: details.file ? [details.file] : null,\n        injectImmediately: details.runAt === \"document_start\",\n        world: scriptingApiDetails?.world || chrome.scripting.ExecutionWorld.ISOLATED,\n      });\n    }\n\n    return new Promise((resolve) => {\n      chrome.tabs.executeScript(tabId, details, (result) => {\n        resolve(result);\n      });\n    });\n  }\n\n  /**\n   * Identifies if the browser autofill settings are overridden by the extension.\n   */\n  static async browserAutofillSettingsOverridden(): Promise<boolean> {\n    if (!(await BrowserApi.permissionsGranted([\"privacy\"]))) {\n      return false;\n    }\n\n    const checkOverrideStatus = (details: chrome.types.ChromeSettingGetResult<boolean>) =>\n      details.levelOfControl === \"controlled_by_this_extension\" && !details.value;\n\n    const autofillAddressOverridden: boolean = await new Promise((resolve) =>\n      chrome.privacy.services.autofillAddressEnabled.get({}, (details) =>\n        resolve(checkOverrideStatus(details)),\n      ),\n    );\n\n    const autofillCreditCardOverridden: boolean = await new Promise((resolve) =>\n      chrome.privacy.services.autofillCreditCardEnabled.get({}, (details) =>\n        resolve(checkOverrideStatus(details)),\n      ),\n    );\n\n    const passwordSavingOverridden: boolean = await new Promise((resolve) =>\n      chrome.privacy.services.passwordSavingEnabled.get({}, (details) =>\n        resolve(checkOverrideStatus(details)),\n      ),\n    );\n\n    return autofillAddressOverridden && autofillCreditCardOverridden && passwordSavingOverridden;\n  }\n\n  /**\n   * Updates the browser autofill settings to the given value.\n   *\n   * @param value - Determines whether to enable or disable the autofill settings.\n   */\n  static async updateDefaultBrowserAutofillSettings(value: boolean) {\n    await chrome.privacy.services.autofillAddressEnabled.set({ value });\n    await chrome.privacy.services.autofillCreditCardEnabled.set({ value });\n    await chrome.privacy.services.passwordSavingEnabled.set({ value });\n  }\n\n  /**\n   * Handles registration of static content scripts within manifest v2.\n   *\n   * @param contentScriptOptions - Details of the registered content scripts\n   */\n  static async registerContentScriptsMv2(\n    contentScriptOptions: browser.contentScripts.RegisteredContentScriptOptions,\n  ): Promise<browser.contentScripts.RegisteredContentScript> {\n    if (typeof browser !== \"undefined\" && !!browser.contentScripts?.register) {\n      return await browser.contentScripts.register(contentScriptOptions);\n    }\n\n    return await registerContentScriptsPolyfill(contentScriptOptions);\n  }\n\n  /**\n   * Handles registration of static content scripts within manifest v3.\n   *\n   * @param scripts - Details of the registered content scripts\n   */\n  static async registerContentScriptsMv3(\n    scripts: chrome.scripting.RegisteredContentScript[],\n  ): Promise<void> {\n    await chrome.scripting.registerContentScripts(scripts);\n  }\n\n  /**\n   * Handles unregistering of static content scripts within manifest v3.\n   *\n   * @param filter - Optional filter to unregister content scripts. Passing an empty object will unregister all content scripts.\n   */\n  static async unregisterContentScriptsMv3(\n    filter?: chrome.scripting.ContentScriptFilter,\n  ): Promise<void> {\n    await chrome.scripting.unregisterContentScripts(filter);\n  }\n}\n","export function isBrowserSafariApi(): boolean {\n  return (\n    navigator.userAgent.indexOf(\" Safari/\") !== -1 &&\n    navigator.userAgent.indexOf(\" Chrome/\") === -1 &&\n    navigator.userAgent.indexOf(\" Chromium/\") === -1\n  );\n}\n","// FIXME: Update this file to be type safe and remove this and next line\n// @ts-strict-ignore\nimport { ConsoleLogService } from \"@bitwarden/common/platform/services/console-log.service\";\n\nimport { BrowserApi } from \"../browser/browser-api\";\nimport BrowserClipboardService from \"../services/browser-clipboard.service\";\n\nimport {\n  OffscreenDocumentExtensionMessage,\n  OffscreenDocumentExtensionMessageHandlers,\n  OffscreenDocument as OffscreenDocumentInterface,\n} from \"./abstractions/offscreen-document\";\n\nclass OffscreenDocument implements OffscreenDocumentInterface {\n  private consoleLogService: ConsoleLogService = new ConsoleLogService(false);\n  private readonly extensionMessageHandlers: OffscreenDocumentExtensionMessageHandlers = {\n    offscreenCopyToClipboard: ({ message }) => this.handleOffscreenCopyToClipboard(message),\n    offscreenReadFromClipboard: () => this.handleOffscreenReadFromClipboard(),\n    localStorageGet: ({ message }) => this.handleLocalStorageGet(message.key),\n    localStorageSave: ({ message }) => this.handleLocalStorageSave(message.key, message.value),\n    localStorageRemove: ({ message }) => this.handleLocalStorageRemove(message.key),\n  };\n\n  /**\n   * Initializes the offscreen document extension.\n   */\n  init() {\n    this.setupExtensionMessageListener();\n  }\n\n  /**\n   * Copies the given text to the user's clipboard.\n   *\n   * @param message - The extension message containing the text to copy\n   */\n  private async handleOffscreenCopyToClipboard(message: OffscreenDocumentExtensionMessage) {\n    await BrowserClipboardService.copy(self, message.text);\n  }\n\n  /**\n   * Reads the user's clipboard and returns the text.\n   */\n  private async handleOffscreenReadFromClipboard() {\n    return await BrowserClipboardService.read(self);\n  }\n\n  private handleLocalStorageGet(key: string) {\n    return self.localStorage.getItem(key);\n  }\n\n  private handleLocalStorageSave(key: string, value: string) {\n    self.localStorage.setItem(key, value);\n  }\n\n  private handleLocalStorageRemove(key: string) {\n    self.localStorage.removeItem(key);\n  }\n\n  /**\n   * Sets up the listener for extension messages.\n   */\n  private setupExtensionMessageListener() {\n    BrowserApi.messageListener(\"offscreen-document\", this.handleExtensionMessage);\n  }\n\n  /**\n   * Handles extension messages sent to the extension background.\n   *\n   * @param message - The message received from the extension\n   * @param sender - The sender of the message\n   * @param sendResponse - The response to send back to the sender\n   */\n  private handleExtensionMessage = (\n    message: OffscreenDocumentExtensionMessage,\n    sender: chrome.runtime.MessageSender,\n    sendResponse: (response?: any) => void,\n  ) => {\n    const handler: CallableFunction | undefined = this.extensionMessageHandlers[message?.command];\n    if (!handler) {\n      return;\n    }\n\n    const messageResponse = handler({ message, sender });\n    if (!messageResponse) {\n      return;\n    }\n\n    Promise.resolve(messageResponse)\n      .then((response) => sendResponse(response))\n      .catch((error) =>\n        this.consoleLogService.error(\"Error resolving extension message response\", error),\n      );\n    return true;\n  };\n}\n\n(() => {\n  const offscreenDocument = new OffscreenDocument();\n  offscreenDocument.init();\n})();\n"],"names":["LogLevel","ConsoleLogService","constructor","isDev","filter","timersMap","Map","debug","message","optionalParams","this","write","Debug","info","Info","warning","Warning","error","Error","level","console","log","warn","measure","start","trackGroup","track","name","properties","measureName","performance","detail","devtools","dataType","duration","mark","Date","toISOString","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","prototype","hasOwnProperty","call","__extends","TypeError","String","__","create","__values","o","s","Symbol","iterator","m","i","length","next","value","done","__read","n","r","e","ar","push","__spreadArray","to","from","pack","arguments","l","slice","concat","SuppressedError","isFunction","ctorFunc","UnsubscriptionError","_super","errors","map","err","toString","join","createImpl","instance","stack","arrRemove","arr","item","index","indexOf","splice","Subscription","initialTeardown","closed","_parentage","_finalizers","empty","unsubscribe","isArray","_parentage_1","_parentage_1_1","remove","initialFinalizer","_finalizers_1","_finalizers_1_1","finalizer","execFinalizer","add","teardown","_hasParent","_addParent","_a","parent","includes","_removeParent","EMPTY","isSubscription","config","onUnhandledError","onStoppedNotification","Promise","undefined","useDeprecatedSynchronousErrorHandling","useDeprecatedNextContext","timeoutProvider","setTimeout","handler","timeout","args","_i","delegate","apply","clearTimeout","handle","noop","COMPLETE_NOTIFICATION","createNotification","kind","context","Subscriber","destination","_this","isStopped","EMPTY_OBSERVER","complete","SafeSubscriber","handleStoppedNotification","nextNotification","_next","_error","_complete","_bind","Function","bind","fn","thisArg","ConsumerObserver","partialObserver","handleUnhandledError","observerOrNext","context_1","errorThrown","reportUnhandledError","notification","subscriber","observable","identity","x","pipeFromArray","fns","input","reduce","prev","Observable","subscribe","_subscribe","lift","operator","source","isObserver","cb","isRoot","errorContext","_trySubscribe","sink","forEach","promiseCtor","getPromiseCtor","resolve","reject","Symbol_observable","pipe","operations","toPromise","ExpiryDateDelimitersPattern","replace","BrowserClientVendors","RegExp","ExtensionCommand","ClientType","DeviceType","Android","iOS","AndroidAmazon","ChromeExtension","FirefoxExtension","OperaExtension","EdgeExtension","VivaldiExtension","SafariExtension","ChromeBrowser","FirefoxBrowser","OperaBrowser","EdgeBrowser","IEBrowser","SafariBrowser","VivaldiBrowser","DuckDuckGoBrowser","UnknownBrowser","WindowsDesktop","MacOsDesktop","LinuxDesktop","UWP","WindowsCLI","MacOsCLI","LinuxCLI","SDK","Server","EventSystemUser","EventType","HttpStatusCode","IntegrationType","NativeMessagingVersion","NotificationType","freeze","KdfChange","SafariApp","sendMessageToApp","command","data","resolveNow","BrowserApi","isSafariApi","messageId","getTime","Math","floor","random","Number","MAX_SAFE_INTEGER","browser","runtime","sendNativeMessage","id","responseData","response","BrowserClipboardService","copy","globalContext","text","isClipboardApiSupported","navigator","clipboard","writeText","consoleLogService","useLegacyCopyMethod","read","useLegacyReadMethod","readText","isLegacyClipboardMethodSupported","textareaElement","document","createElement","textContent","style","position","body","appendChild","select","execCommand","removeChild","focus","method","queryCommandSupported","BrowserPlatformUtilsService","clipboardWriteCallback","offscreenDocumentService","getDevice","deviceCache","isFirefox","isOpera","isEdge","isVivaldi","isChrome","isSafari","getDeviceString","toLowerCase","getClientType","Browser","userAgent","chrome","opr","addons","opera","safariVersion","match","isChromium","shouldApplySafariHeightFix","version","parts","split","v","isIE","isMacAppStore","isPopupOpen","sendMessage","lastError","Boolean","lockTimeout","launchUri","uri","options","createNewTab","extensionPage","getApplicationVersion","manifest","getManifest","version_name","getApplicationVersionNumber","trim","supportsWebAuthn","win","PublicKeyCredential","supportsDuo","supportsAutofill","supportsFileDownloads","isSelfHost","copyToClipboard","windowContext","window","clearing","clearMs","handleClipboardWriteCallback","then","isManifestVersion","offscreenApiSupported","triggerOffscreenCopyToClipboard","readFromClipboard","triggerOffscreenReadFromClipboard","supportsSecureStorage","getAutofillKeyboardShortcut","autofillCommand","commands","getAll","find","c","shortcut","getPlatformInfo","os","packageType","withDocument","offscreen","Reason","CLIPBOARD","sendMessageWithResponse","registerContentScripts","registerContentScriptsPolyfill","contentScriptOptions","callback","logService","chromeProxy","globalThis","NestedProxy","patternValidationRegex","gotScripting","scripting","gotNavigation","target","Proxy","get","prop","arguments_","result","assertValidPattern","matchPattern","isValidPattern","test","getRawPatternRegex","protocol","host","pathname","replaceAll","patternToRegex","matchPatterns","castAllFramesTarget","allFrames","tabId","frameId","castArray","possibleArray","createTarget","frameIds","insertCSS","files","matchAboutBlank","runAt","ignoreTargetErrors","everyInsertion","all","content","file","css","code","tabs","catchTargetInjectionErrors","assertNoCode","some","executeScript","normalizedFiles","injection","executions","at","injectContentScript","where","scripts","targets","injectContentScriptInSpecificTarget","injections","flatMap","script","match_about_blank","run_at","js","promise","isOriginPermitted","url","permissions","contains","origins","URL","origin","matches","excludeMatches","pattern","matchesRegex","excludeMatchesRegex","inject","tabListener","status","navListener","addListener","webNavigation","onCommitted","onUpdated","registeredContentScript","unregister","removeListener","buildRegisterContentScriptsPolyfill","manifestVersion","manifest_version","expectedVersion","senderIsInternal","sender","logger","extensionUrl","getURL","normalizedOrigin","normalizedExtensionUrl","startsWith","getWindows","windows","populate","getWindow","windowId","getWindowById","getCurrentWindow","getCurrent","createWindow","newWindow","allWindows","windowTypes","mainWindow","update","focused","removeWindow","updateWindowProperties","focusWindow","getTabFromCurrentWindowId","tabsQueryFirstCurrentWindowForSafari","active","WINDOW_ID_CURRENT","getBrowserClientVendor","clientWindow","getTab","tab","getTabFromCurrentWindow","currentWindow","getActiveTabs","tabsQuery","getCurrentTab","closeTab","isWebExtensionsApi","catch","isChromeApi","navigateTabToUrl","href","query","tabsQueryFirst","currentWindowId","t","tabSendMessageData","obj","tabSendMessage","rejectOnError","sendTabsMessage","responseCallback","getRuntimeURL","path","onWindowCreated","onCreated","getBackgroundPage","extension","isBackgroundPage","getExtensionViews","fetchProperties","getViews","type","getFrameDetails","details","getFrame","getAllFrameDetails","getAllFrames","messageListener","onMessage","messageListener$","storageChangeListener","storage","onChanged","event","self","trackedChromeEventListeners","setupUnloadListeners","findIndex","_event","eventListener","addEventListener","arg","assign","focusTab","highlighted","closePopup","isFirefoxOnAndroid","finally","close","gaFilter","getUILanguage","i18n","reloadExtension","location","reload","reloadOpenWindows","exemptCurrentHref","views","currentHref","w","connectNative","application","requestPermission","permission","request","permissionsGranted","getBrowserAction","action","browserAction","getSidebarAction","deviceType","sidebarAction","captureVisibleTab","format","executeScriptInTab","scriptingApiDetails","injectImmediately","world","ExecutionWorld","ISOLATED","browserAutofillSettingsOverridden","checkOverrideStatus","levelOfControl","autofillAddressOverridden","privacy","services","autofillAddressEnabled","autofillCreditCardOverridden","autofillCreditCardEnabled","passwordSavingOverridden","passwordSavingEnabled","updateDefaultBrowserAutofillSettings","set","registerContentScriptsMv2","contentScripts","register","registerContentScriptsMv3","unregisterContentScriptsMv3","unregisterContentScripts","OffscreenDocument","extensionMessageHandlers","offscreenCopyToClipboard","handleOffscreenCopyToClipboard","offscreenReadFromClipboard","handleOffscreenReadFromClipboard","localStorageGet","handleLocalStorageGet","key","localStorageSave","handleLocalStorageSave","localStorageRemove","handleLocalStorageRemove","handleExtensionMessage","sendResponse","messageResponse","init","setupExtensionMessageListener","localStorage","getItem","setItem","removeItem"],"ignoreList":[],"sourceRoot":""}